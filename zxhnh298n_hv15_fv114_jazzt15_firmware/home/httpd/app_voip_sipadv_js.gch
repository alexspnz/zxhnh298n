<script language="javascript">var VPDTMF_PARA = new Array("DTMFMethod","DTMFRedEnable");var RTPADV_PARA= new Array("JitMode","FixedJitLen","AdaptJitMin","AdaptJitMax","SupppressRTPOnSilence","G726Endian");var VOICEPROC_PARA = new Array("ReceiveGain","TransmitGain","EchoCancellationTail","EchoCancellationEnable","DCFDisable","FixedTransmitGain","ReceiveToneGain","TransmitToneGain");var CIDCFG_PARA = new Array("ViewName","CIDMode");var LineNumber = parseInt(getValue("IF_INSTNUM"),10);function getmsg(id){var str = new Array();str[0] = new Array(118, "&?error_118;");str[1] = new Array(119, "&?error_119;");str[2] = new Array(122, "&?error_122;");str[3] = new Array(101, "&?error_101;");str[4] = new Array(115, "&?error_115;");str[5] = new Array(116, "&?error_116;");str[6] = new Array(117, "&?error_117;");str[7] = new Array(159, "&?error_159;");return getMsgFormArray(str, arguments);}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");ProcessRet(errstr, errpara);pageGetValue();change_mode();}function ChangeVP(){jslSetValue("IF_INDEX", "Frm_VP");getObj("fSubmit").submit();}function change_mode(){var mode = getValue("Frm_JitMode");switch (mode){case "0":{jslDiDisplay("TR_AdaptJitMax","TR_AdaptJitMin");jslEnDisplay("TR_FixedJitLen");jslSetValue("Frm_FixedJitLen", "FixedJitLen");break;}case "1":{jslEnDisplay("TR_AdaptJitMax","TR_AdaptJitMin");jslDiDisplay("TR_FixedJitLen");jslSetValue("Frm_AdaptJitMax", "AdaptJitMax");jslSetValue("Frm_AdaptJitMin", "AdaptJitMin");break;}default:break;}}function pageGetValue(){jslSetValue("Frm_VP", "IF_INDEX");jslSetValue("Frm_DTMFMethod", "DTMFMethod");jslSetValue("Frm_JitMode", "JitMode");jslSetValue("Frm_CIDCFG", "CIDMode");var VPvalue = getValue("Frm_VP");if(0 == VPvalue){jslEnDisplay("Tr_EchoCancellationEnable0","Tr_TransmitGain0","Tr_ReceiveGain0");jslDiDisplay("Tr_EchoCancellationEnable1","Tr_TransmitGain1","Tr_ReceiveGain1");}else if(1 == VPvalue){jslEnDisplay("Tr_EchoCancellationEnable1","Tr_TransmitGain1","Tr_ReceiveGain1");jslDiDisplay("Tr_EchoCancellationEnable0","Tr_TransmitGain0","Tr_ReceiveGain0");}else {}for(var i=0; i < LineNumber; i++){jslSetValue("Frm_EchoCancellationEnable"+i, "EchoCancellationEnable"+i);var RealTransmitGain1 = (parseInt(getValue("TransmitGain"+i),10)/10) -14;var RealReceiveGain1 = (parseInt(getValue("ReceiveGain"+i),10)/10) -14;setValue("Frm_TransmitGain"+i,RealTransmitGain1);setValue("Frm_ReceiveGain"+i,RealReceiveGain1);}}function pageSetValue(){HiddenParaInit(VPDTMF_PARA);HiddenParaInit(RTPADV_PARA);HiddenParaInit(CIDCFG_PARA);jslSetValue("IF_INDEX", "Frm_VP");for(var i=0; i < LineNumber; i++){HiddenMultiInstParaInit(VOICEPROC_PARA, i);}jslSetValue("DTMFMethod", "Frm_DTMFMethod");jslSetValue("JitMode", "Frm_JitMode");for(var i=0; i < LineNumber; i++){jslSetValue("EchoCancellationEnable"+i, "Frm_EchoCancellationEnable"+i);var RealTransmitGain = (parseInt(getValue("Frm_TransmitGain"+i),10)+14) * 10;var RealReceiveGain = (parseInt(getValue("Frm_ReceiveGain"+i),10)+14) * 10;setValue("TransmitGain"+i, RealTransmitGain);setValue("ReceiveGain"+i, RealReceiveGain);}var mode = getValue("Frm_JitMode");switch (mode){case "0":{jslSetValue("FixedJitLen", "Frm_FixedJitLen");break;}case "1":{jslSetValue("AdaptJitMax", "Frm_AdaptJitMax");jslSetValue("AdaptJitMin", "Frm_AdaptJitMin");break;}default:break;}jslSetValue("CIDMode", "Frm_CIDCFG");}function checkRange(Frm_Str, Fnt_Str, min, max){var Str = getValue(Frm_Str);var Tmp = checkIntegerRange(Str, min, max);if(-1 == Tmp){msg = getmsg(101);ShowErrorForCom(Frm_Str,Fnt_Str,msg);return false;}else if(-2 == Tmp){msg = getmsg(115);ShowErrorForCom(Frm_Str,Fnt_Str,msg);return false;}else if(-3 == Tmp){msg = getmsg(116,min,max);ShowErrorForCom(Frm_Str,Fnt_Str,msg);return false;}else {}}function pageCheckValue(){var mode = getValue("Frm_JitMode");var msg = "";if ("0"== mode){FixLen = getValue("Frm_FixedJitLen");var mm = checkIntegerRange(FixLen, 0, 200);if(-1 == mm){msg = getmsg(101);ShowErrorForCom("Frm_FixedJitLen","Fnt_FixedJitLen",msg);return false;}else if(-2 == mm){msg = getmsg(115);ShowErrorForCom("Frm_FixedJitLen","Fnt_FixedJitLen",msg);return false;}else if(-3 == mm){msg = getmsg(116,0,200);ShowErrorForCom("Frm_FixedJitLen","Fnt_FixedJitLen",msg);return false;}else {}}else {var MaxLen = getValue("Frm_AdaptJitMax");var MinLen = getValue("Frm_AdaptJitMin");var mm1 = checkIntegerRange(MaxLen, 0, 200);var mm2 = checkIntegerRange(MinLen, 0, 200);if(-1 == mm1){msg = getmsg(101);ShowErrorForCom("Frm_AdaptJitMax","Fnt_AdaptJitMax",msg);return false;}else if(-2 == mm1){msg = getmsg(115);ShowErrorForCom("Frm_AdaptJitMax","Fnt_AdaptJitMax",msg);return false;}else if(-3 == mm1){msg = getmsg(116,0,200);ShowErrorForCom("Frm_AdaptJitMax","Fnt_AdaptJitMax",msg);return false;}else {}if(-1 == mm2){msg = getmsg(101);ShowErrorForCom("Frm_AdaptJitMin","Fnt_AdaptJitMin",msg);return false;}else if(-2 == mm2){msg = getmsg(115);ShowErrorForCom("Frm_AdaptJitMin","Fnt_AdaptJitMin",msg);return false;}else if(-3 == mm2){msg = getmsg(116,0,200);ShowErrorForCom("Frm_AdaptJitMin","Fnt_AdaptJitMin",msg);return false;}else {}if (parseInt(MaxLen,10) < parseInt(MinLen,10)){msg = getmsg(159);ShowErrorForCom(null,null,msg);return false;}}for(var i=0; i < LineNumber; i++){if(checkRange("Frm_TransmitGain"+i,"Fnt_TransmitGain"+i,-14,6) == false){return false;}if(checkRange("Frm_ReceiveGain"+i,"Fnt_ReceiveGain"+i,-14,6) == false){return false;}}return true;}function pageCancel(){DisableALL();getObj("fSubmit").submit();}function pageSubmit(){ReSetValueRmZero("Frm_AdaptJitMax","Frm_AdaptJitMin","Frm_FixedJitLen");if(pageCheckValue() == true){pageSetValue();setValue("IF_ACTION", "apply");DisableALL();getObj("fSubmit").submit();}else {}}</script>