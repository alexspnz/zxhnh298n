<script language="javascript">var WDS_PARA = new Array("WDSMac1","WDSMac2","WDSMac3","WDSMac4","WDSConnectStatus1","WDSConnectStatus2","WDSConnectStatus3","WDSConnectStatus4");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(118, "&?error_118;");str[2] = new Array(119, "&?error_119;");str[3] = new Array(122, "&?error_122;");str[4] = new Array(520, "&?error_520;");str[5] = new Array(521, "&?error_521;");str[6] = new Array(522, "&?error_522;");str[7] = new Array(110, "&?error_110;");return getMsgFormArray(str, arguments)}function Wireless_switch(){var RealRF = "<%=getenv("RealRF");%>";var wdsMode = "<%=getenv("WdsMode");%>";if(RealRF == "1"){jslDiDisplay("t_warn");}else {jslEnDisplay("t_warn");if (wdsMode == "WDS_Disable"){jslDisable("Frm_WDS_Mode");}else if (wdsMode == "WDS_Root"){for (var i=0; i<4; i++){var order = i+1;jslDisable("mac"+order+"1", "mac"+order+"2","mac"+order+"3","mac"+order+"4","mac"+order+"5","mac"+order+"6");}jslDisable("Frm_WDS_Mode", "Frm_repeater_set");}else if (wdsMode == "WDS_Repeater"){jslDisable("Frm_WDS_Mode", "mac1", "mac2","mac3","mac4","mac5","mac6", "Frm_root_set");}}}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);pageGetValue();Wireless_switch();}function toNext(obj){}function getMacValue(i){if (i == 0){var value = getValue("mac1");value += ":"+ getValue("mac2");value += ":"+ getValue("mac3");value += ":"+ getValue("mac4");value += ":"+ getValue("mac5");value += ":"+ getValue("mac6");}else {var value = getValue("mac"+i+"1");value += ":"+ getValue("mac"+i+"2");value += ":"+ getValue("mac"+i+"3");value += ":"+ getValue("mac"+i+"4");value += ":"+ getValue("mac"+i+"5");value += ":"+ getValue("mac"+i+"6");}if( ":::::"== value){value = "";}return value;}function CheckMac(Addr){var c = '';var i = 0, j = 0;var addrParts = Addr.split(':');if ( addrParts.length != 6 )return false;for (i = 0; i < 6; i++){if (addrParts[i].length != 2)return false;for ( j = 0; j < addrParts[i].length; j++ ){c = addrParts[i].toLowerCase().charAt(j);if ( (c >= '0' && c <= '9') ||(c >= 'a' && c <= 'f') )continue;else return false;}}return true;}function X_CheckMac(Addr, Fnt){var msg = "";var value = Addr;if(value == ""){msg = getmsg(101);ShowErrorForCom("mac1",Fnt,msg);return false;}if((CheckMac(value) != true)&&(value !="")){msg = getmsg(110);ShowErrorForCom("mac1",Fnt,msg);return false;}if ( value.toLowerCase() == "ff:ff:ff:ff:ff:ff"){msg = getmsg(110);ShowErrorForCom("mac1",Fnt,msg);return false;}if ( value.toLowerCase() == "00:00:00:00:00:00"){msg = getmsg(110);ShowErrorForCom("mac1",Fnt,msg);return false;}return true;}function WDS_Mode_switch(){jslSetValue("WdsMode", "Frm_WDS_Mode");setValue("IF_ACTION", "modeChange");DisableALL();getObj("fSubmit").submit();}<%var wds_mode = getenv("wdsMode");if (wds_mode == "WDS_Disable"){%>function pageGetValue(){jslSetValue("Frm_WDS_Mode", "WdsMode");}<%}else if (wds_mode == "WDS_Root"){%>function pageGetValue(){jslSetValue("Frm_WDS_Mode", "WdsMode");for (var i=0; i<4; i++){var order_i = i+1;var mac = getValue("WDSMac"+order_i);if ("00:00:00:00:00:00"== mac){continue;}var macArr = mac.split(":");if (6 != macArr.length){alert("mac length error.");return false;}for (var j=0; j<macArr.length; j++){if (2 != macArr[i].length){alert("mac cell length should be 2.");return false;}var order_j = j+1;setValue("mac"+order_i+order_j, macArr[j]);}}}function pageCheckValue(){var macArr = new Array(4);for (var i=0; i<4; i++){macArr[i] = getMacValue(i+1);if (""== macArr[i]){continue;}var order = i+1;if (X_CheckMac(macArr[i], "Fnt_repeater_mac"+order) == false){return false;}}for (var i=0; i<4; i++){if (""== macArr[i]){continue;}for (var j=i+1; j<4; j++){if (""== macArr[j]){continue;}if (macArr[i] == macArr[j]){msg = getmsg(522);var order = j+1;ShowErrorForCom("mac"+order+"1", null, msg);return false;}}}return true;}function repeater_mac_add(){var changeFlag = 0;if (pageCheckValue() == true){for (var i=0; i<4; i++){var order = i+1;var macAddr = getMacValue(order);if (""== macAddr){macAddr = "00:00:00:00:00:00";}var macAddrHidden = getValue("WDSMac"+order);if (macAddr !== macAddrHidden){changeFlag = 1;}setValue("WDSMac"+order, macAddr);jslDisable("mac"+order+"1", "mac"+order+"2","mac"+order+"3","mac"+order+"4","mac"+order+"5","mac"+order+"6");}if (1 == changeFlag){setValue("IF_ACTION", "repeaterAdd");}jslDisable("Frm_repeater_set");DisableALL();getObj("fSubmit").submit();}}<%}else if (wds_mode == "WDS_Repeater"){%>function pageGetValue(){jslSetValue("Frm_WDS_Mode", "WdsMode");var rootMac = getValue("WDSMac1");if (rootMac == "00:00:00:00:00:00"){return;}var addrParts = rootMac.split(':');if ( addrParts.length != 6 )return false;for (i = 0; i < 6; i++){if (addrParts[i].length != 2)return false;setValue("mac"+(i+1), addrParts[i]);}}function pageCheckValue(){var macAddr = getMacValue(0);if (""== macAddr){return true;}if (X_CheckMac(macAddr, "Fnt_root_mac") == false){return false;}return true;}function root_mac_set(){var changeFlag = 0;if (pageCheckValue() == true){var macAddr = getMacValue(0);if (""== macAddr){macAddr = "00:00:00:00:00:00";}var macAddrHidden = getValue("WDSMac1");if (macAddr != macAddrHidden){changeFlag = 1;}if (1 == changeFlag){setValue("IF_ACTION", "rootSet");}setValue("WDSMac1", macAddr);jslDisable("mac1", "mac2","mac3","mac4","mac5","mac6","Frm_root_set");DisableALL();getObj("fSubmit").submit();}}<%}%></script>