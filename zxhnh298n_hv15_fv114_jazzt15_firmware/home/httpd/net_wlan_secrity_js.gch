<script language="javascript">var PSK_PARA = new Array("PreSharedKey","KeyPassphrase","AssociatedDeviceMACAddress");var CONFIG_PARA = new Array("Enable","RadioStatus","Standard","BeaconInterval","RtsCts","Fragment","DTIM","TxPower","CountryCode","TxRate","Channel","ESSID","ESSIDPrefix","ACLPolicy","BeaconType","WEPAuthMode","WEPEncryptionLevel","WEPKeyIndex","WPAAuthMode","WPAEncryptType","WPAGroupRekey","WPAEAPServerIp","RadiusPort","RadiusServerPort","WPAEAPSecret","PossibleChannels","BasicDataRates","OpDataRates","PossibleTxRates","OOBAccessEnabled","BeaconEnabled","ESSIDHideEnable","RegulatoryDomain","WlanMode","DistanceFromRoot","PeerBSSID","AuthServiceMode","QosType","Priority","UAPSDEnabled","AutoChannelEnabled","ChannelsInUse","11iAuthMode","11iEncryptType");var WEPKEY_PARA = new Array("WEPKey");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(102, "&?error_102;");str[2] = new Array(103, "&?error_103;");str[3] = new Array(114, "&?error_114;");str[4] = new Array(115, "&?error_115;");str[5] = new Array(116, "&?error_116;");str[6] = new Array(117, "&?error_117;");str[7] = new Array(118, "&?error_118;");str[8] = new Array(119, "&?error_119;");str[9] = new Array(120, "&?error_120;");str[10] = new Array(121, "&?error_121;");str[11] = new Array(122, "&?error_122;");str[12] = new Array(240, "&?error_240;");str[13] = new Array(241, "&?error_241;");return getMsgFormArray(str, arguments);}function Wireless_switch(){var tem=getValue("Frm_Authentication");var keyobj=getObj("Frm_BeaconType");if(getValue("RealRF") == "1"){jslDiDisplay("t_warn");if(tem=="Open System"){if(key=="Basic"){jslEnable("Frm_WEPEncryptionLevel","Frm_WEPKeyIndex","Frm_WEPKey0","Frm_WEPKey1","Frm_WEPKey2","Frm_WEPKey3");}jslEnable("Frm_BeaconType");}else if(tem=="Shared Key"){jslEnable("Frm_BeaconType","Frm_WEPEncryptionLevel","Frm_WEPKeyIndex","Frm_WEPKey0","Frm_WEPKey1","Frm_WEPKey2","Frm_WEPKey3");}else if(tem=="WPA-PSK"||tem=="WPA2-PSK"||tem=="WPA/WPA2-PSK"){jslEnable("Frm_KeyPassphrase","Frm_WPAGroupRekey","Frm_WPAEncryptType");}jslEnable("Frm_SSID_SET","Frm_Authentication","Btn_Submit","Btn_Cancel");}else {jslEnDisplay("t_warn");if(tem=="Open System"){if(key=="Basic"){jslDisable("Frm_WEPEncryptionLevel","Frm_WEPKeyIndex","Frm_WEPKey0","Frm_WEPKey1","Frm_WEPKey2","Frm_WEPKey3");}jslDisable("Frm_BeaconType");}else if(tem=="Shared Key"){jslDisable("Frm_BeaconType","Frm_WEPEncryptionLevel","Frm_WEPKeyIndex","Frm_WEPKey0","Frm_WEPKey1","Frm_WEPKey2","Frm_WEPKey3");}else if(tem=="WPA-PSK"||tem=="WPA2-PSK"||tem=="WPA/WPA2-PSK"){jslDisable("Frm_KeyPassphrase","Frm_WPAGroupRekey","Frm_WPAEncryptType");}jslDisable("Frm_SSID_SET","Frm_Authentication","Btn_Submit","Btn_Cancel");}}function Authentication(){var tem=getValue("Frm_Authentication");var keyobj=getObj("Frm_BeaconType");var i;if(tem=="Open System"){keyobj.length = 2;keyobj.options[0] = new Option("&?Disabled;", "None");keyobj.options[1] = new Option("&?wan049;", "Basic");jslDiDisplay("wpa","shared");jslEnDisplay("t_wep");}else if(tem=="Shared Key"){keyobj.length = 1;keyobj.options[0] = new Option("&?wan049;", "Basic");jslDiDisplay("wpa");jslEnDisplay("shared","t_wep");}else if(tem=="WPA-PSK"||tem=="WPA2-PSK"||tem=="WPA/WPA2-PSK"){jslDiDisplay("shared","t_wep");jslEnDisplay("wpa");}}function UpdateAuthentication(){var tem=getValue("Frm_Authentication");var keyobj=getObj("Frm_BeaconType");var i;if(tem=="Open System"){keyobj.length = 2;keyobj.options[0] = new Option("&?Disabled;", "None");keyobj.options[1] = new Option("&?wan049;", "Basic");jslSetValue("Frm_BeaconType","BeaconType");key=getValue("Frm_BeaconType");if(key=="Basic"){jslEnDisplay("shared");}if(key=="None"){jslDiDisplay("shared");}jslEnDisplay("t_wep");jslDiDisplay("wpa");}else if(tem=="Shared Key"){keyobj.length = 1;keyobj.options[0] = new Option("&?wan049;", "Basic");jslSetValue("Frm_BeaconType","BeaconType");key=getValue("Frm_BeaconType");jslDiDisplay("wpa");jslEnDisplay("shared","t_wep");}else if(tem=="WPA-PSK"||tem=="WPA2-PSK"||tem=="WPA/WPA2-PSK"){jslDiDisplay("shared","t_wep");jslEnDisplay("wpa");}}function WEPEncryptionLevel(){var Level = getValue("Frm_WEPEncryptionLevel");var MaxLen;if (Level == "104-bit"){MaxLen = 26;}else if (Level == "40-bit"){MaxLen = 10;}for (var i = 0; i < 4; i ++){getObj("Frm_WEPKey"+i).maxlength = MaxLen;}}function WEP_Key(){var tem=getValue("Frm_Authentication");var key=getValue("Frm_BeaconType");if(tem=="Open System"){if(key=="Basic"){jslEnDisplay("shared");}if(key=="None"){jslDiDisplay("shared");}}}function AsciiCheck(Key, LenLimit){if (Key.length != LenLimit){return false;}for (var j = 0 ;j < Key.length; j++){var ch = Key.charCodeAt(j);if (!(ch >= 0 && ch <= 255)){return false;}}return true;}function HexCheck(Key, LenLimit){if (Key.length != LenLimit){return false;}for (var j = 0 ;j < Key.length; j++){var ch = Key.charCodeAt(j);if (!((ch >= 65 && ch <= 70)||(ch >= 97 && ch <= 102)||(ch >= 48 && ch <= 57))){return false;}}return true;}function WepkeyCheck(){var Key, KeyLen, KeyIndex;var AsciiLenLimit, HexLenLimit;var check;KeyLen = getValue("Frm_WEPEncryptionLevel");KeyIndex_tmp = getValue("Frm_WEPKeyIndex");KeyIndex = KeyIndex_tmp-1;if (getDisplay("shared") == false){return true;}Key = getValue("Frm_WEPKey"+KeyIndex);check = checkNull(Key);if (check == false){msg = getmsg(101);ShowErrorForCom("Frm_WEPKey"+KeyIndex, "Fnt_WEPKey"+KeyIndex, msg);return false;}if (KeyLen == "104-bit"){AsciiLenLimit = 13;HexLenLimit = 26;if (AsciiCheck(Key, AsciiLenLimit) == false && HexCheck(Key, HexLenLimit) == false){msg = getmsg(120);ShowErrorForCom("Frm_WEPKey"+KeyIndex, "Fnt_WEPKey"+KeyIndex, msg);return false;}}if (KeyLen == "40-bit"){AsciiLenLimit = 5;HexLenLimit = 10;if (AsciiCheck(Key, AsciiLenLimit) == false && HexCheck(Key, HexLenLimit) == false){msg = getmsg(121);ShowErrorForCom("Frm_WEPKey"+KeyIndex, "Fnt_WEPKey"+KeyIndex, msg);return false;}}return true;}function WPAGroupRekeyCheck(){if (getDisplay("wpa") == false){return true;}var check = checkIntegerRange(getValue("Frm_WPAGroupRekey"), 100, 1000);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_WPAGroupRekey","Fnt_WPAGroupRekey",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_WPAGroupRekey","Fnt_WPAGroupRekey",msg);return false;}if (check == -3){if(getValue("Frm_WPAGroupRekey") != "0"){msg = getmsg(240,100,1000);ShowErrorForCom("Frm_WPAGroupRekey","Fnt_WPAGroupRekey",msg);return false;}}return true;}function KeyPassphraseCheck(){if(getDisplay("wpa") == false){return true;}var value = getValue("Frm_KeyPassphrase");var check = checkStrLengthRange(value, 8, 63);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_KeyPassphrase","Fnt_KeyPassphrase",msg);return false;}if (check == -3){msg = getmsg(102,8,63);ShowErrorForCom("Frm_KeyPassphrase","Fnt_KeyPassphrase",msg);return false;}check = checkGenStringForASC(value);if (check == false){msg = getmsg(114);ShowErrorForCom("Frm_KeyPassphrase","Fnt_KeyPassphrase",msg);return false;}return true;}function AllCheck(){if(WepkeyCheck() == false){return false;}if(WPAGroupRekeyCheck() == false){return false;}if(KeyPassphraseCheck() == false){return false;}return true;}function ESSID_Choose(){var url = getURL("net_wlan_secrity_t.gch", "IF_VIEWID", getValue("Frm_SSID_SET"));DisableALL();location.href = url;}function pageLoad(url){moveErrLayer(580,145);getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");if (errstr != "SUCC"&& errpara != "SUCC"){if((errpara == "WEPAuthMod") || (errpara == "BeaconType")|| (errpara == "WPAAuthMode") || (errpara == "11iAuthMode")){errpara = "Authentication";}}ProcessRet(errstr, errpara);pageGetValue();}function pageGetValue(){jslSetValue("Frm_SSID_SET", "IF_VIEWID");if(getValue("BeaconType") == "None"|| (getValue("WEPAuthMode") == "None"&& getValue("BeaconType") == "Basic")){setValue("Frm_Authentication", "Open System");jslSetValue("Frm_BeaconType","BeaconType");}if(getValue("WEPAuthMode") == "SharedAuthentication"&& getValue("BeaconType") == "Basic"){setValue("Frm_Authentication", "Shared Key");jslSetValue("Frm_BeaconType","BeaconType");}if((getValue("BeaconType") == "WPA") && (getValue("WPAAuthMode") == "PSKAuthentication")){setValue("Frm_Authentication", "WPA-PSK");jslSetValue("Frm_WPAEncryptType","WPAEncryptType");}if((getValue("BeaconType") == "11i") && (getValue("11iAuthMode") == "PSKAuthentication")){setValue("Frm_Authentication", "WPA2-PSK");jslSetValue("Frm_WPAEncryptType","11iEncryptType");}if((getValue("BeaconType") == "WPAand11i") && (getValue("WPAAuthMode") == "PSKAuthentication")&& (getValue("11iAuthMode") == "PSKAuthentication")){setValue("Frm_Authentication", "WPA/WPA2-PSK");jslSetValue("Frm_WPAEncryptType","WPAEncryptType");}jslSetValue("Frm_WEPEncryptionLevel","WEPEncryptionLevel");jslSetValue("Frm_WEPKeyIndex","WEPKeyIndex");jslSetValue("Frm_WEPKey0","WEPKey0");jslSetValue("Frm_WEPKey1","WEPKey1");jslSetValue("Frm_WEPKey2","WEPKey2");jslSetValue("Frm_WEPKey3","WEPKey3");jslSetValue("Frm_KeyPassphrase","KeyPassphrase");jslSetValue("Frm_WPAGroupRekey","WPAGroupRekey");WEPEncryptionLevel();UpdateAuthentication();Wireless_switch();}function pageSetValue(){HiddenParaInit(CONFIG_PARA);if(getValue("Frm_Authentication") == "Open System"){jslSetValue("BeaconType","Frm_BeaconType");if (getValue("Frm_BeaconType") == "Basic"){setValue("WEPAuthMode", "None");}}if(getValue("Frm_Authentication") == "Shared Key"){jslSetValue("BeaconType","Frm_BeaconType");setValue("WEPAuthMode", "SharedAuthentication");}if(getValue("Frm_Authentication") == "WPA-PSK"){HiddenParaInit(PSK_PARA);setValue("BeaconType", "WPA");setValue("WPAAuthMode", "PSKAuthentication");jslSetValue("WPAEncryptType","Frm_WPAEncryptType");jslSetValue("KeyPassphrase","Frm_KeyPassphrase");jslSetValue("WPAGroupRekey","Frm_WPAGroupRekey");}if(getValue("Frm_Authentication") == "WPA2-PSK"){HiddenParaInit(PSK_PARA);setValue("BeaconType", "11i");setValue("11iAuthMode", "PSKAuthentication");jslSetValue("11iEncryptType","Frm_WPAEncryptType");jslSetValue("KeyPassphrase","Frm_KeyPassphrase");jslSetValue("WPAGroupRekey","Frm_WPAGroupRekey");}if(getValue("Frm_Authentication") == "WPA/WPA2-PSK"){HiddenParaInit(PSK_PARA);setValue("BeaconType", "WPAand11i");setValue("WPAAuthMode", "PSKAuthentication");setValue("11iAuthMode", "PSKAuthentication");jslSetValue("WPAEncryptType","Frm_WPAEncryptType");jslSetValue("11iEncryptType","Frm_WPAEncryptType");jslSetValue("KeyPassphrase","Frm_KeyPassphrase");jslSetValue("WPAGroupRekey","Frm_WPAGroupRekey");}if (getDisplay("shared") == true){for(var i=0; i<4; i++){HiddenMultiInstParaInit(WEPKEY_PARA, i);}setValue("WEPKey", "NULL");for(var j=0; j<WEPKEY_PARA.length; j++){val = WEPKEY_PARA[j];WEPKEY_PARA[j] = "NULL";}jslSetValue("WEPEncryptionLevel","Frm_WEPEncryptionLevel");jslSetValue("WEPKeyIndex","Frm_WEPKeyIndex");for (var k = 0; k < 4; k++){jslSetValue("WEPKey"+k,"Frm_WEPKey"+k);if ((k+1) == getValue("WEPKeyIndex")){jslSetValue("WEPKey","Frm_WEPKey"+k);}}}}function pageSubmit(){if(AllCheck() == true){ReSetValueRmZero("Frm_WPAGroupRekey");jslDisable("Btn_Submit","Btn_Cancel");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_CONFIGTAG", "Y");if (getDisplay("wpa") == true){setValue("IF_PSKTAG", "Y");}else {setValue("IF_PSKTAG", "N");}if (getDisplay("shared") == true){setValue("IF_WEPKEYTAG", "Y");}else {setValue("IF_WEPKEYTAG", "N");}setValue("IF_VIEWID", getValue("Frm_SSID_SET"));DisableALL();getObj("fSubmit").submit();}}function pageCancel(){jslDisable("Btn_Submit","Btn_Cancel");DisableALL();getObj("fSubmit").submit();}</script>