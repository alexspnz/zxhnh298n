<script language="javascript">var CLIENT_PARA = new Array("Enable","Hidden","Status","LastError","Interface","DomainName","Service","Username","Password","Offline","HostNumber");var SERVICE_PARA = new Array("Name","Server","ServerPort","Request","UpdateInterval","RetryInterval","MaxRetries");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(102, "&?error_102;");str[2] = new Array(103, "&?error_103;");str[3] = new Array(104, "&?error_104;");str[4] = new Array(114, "&?error_114;");str[5] = new Array(118, "&?error_118;");str[6] = new Array(119, "&?error_119;");str[7] = new Array(122, "&?error_122;");str[8] = new Array(106, "&?error_106;");return getMsgFormArray(str, arguments)}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);moveErrLayer(595,93);pageGetValue();}function pageGetValue(){var pwdStr = "";jslPostToViewCheckBox("Frm_Enable", "Enable");jslSetValue("Frm_Username", "Username");jslSetValue("Frm_Password", "Password", "GET");jslDoShowComboBox("Frm_Interface", "Interface");var service=getValue("Service");var name=getValue("IF_NAME");if(service==""&&name=="NULL"){setValue("Frm_Name","dipc");}else if(service==""&&name!="NULL"){setValue("Frm_Name",name);}else {jslSetValue("Frm_Name", "Service");}<%var DDNS_INSTNUM = query_list("OBJ_DDNSSERVICE_ID", "IGD");for(var i=0;i<DDNS_INSTNUM;i++){var DDNS_HANDLE = create_paralist();var DDNS_IDENTITY = query_identity(i);get_inst(DDNS_HANDLE, "OBJ_DDNSSERVICE_ID", DDNS_IDENTITY);var Name = get_para(DDNS_HANDLE, "Name");%>if("<%=Name;%>"==getValue("Frm_Name")){<%var Server = get_para(DDNS_HANDLE, "Server");%>setValue("Frm_Server", "<%=Server;%>");}<%destroy_paralist(DDNS_HANDLE);}%>jslSetValue("Frm_DomainName", "DomainName");if(getValue("Frm_Name")=="dyndns"){jslEnDisplay("Frm_DomainName","Fnt_DomainName");document.getElementById("Fnt_DomainName").innerHTML="&?ddns006;";}else if(getValue("Frm_Name")=="dipc"){jslEnDisplay("Frm_DomainName","Fnt_DomainName");document.getElementById("Fnt_DomainName").innerHTML="&?ddns004;";}else if(getValue("Frm_Name")=="DtDNS"){jslDiDisplay("Frm_DomainName","Fnt_DomainName");}else if(getValue("Frm_Name")=="No-IP"){jslDiDisplay("Frm_DomainName","Fnt_DomainName");}}function pageSetValue(){HiddenParaInit(CLIENT_PARA);HiddenParaInit(SERVICE_PARA);jslViewToPostCheckBox("Enable", "Frm_Enable");jslSetValue("Server", "Frm_Server");jslSetValue("Username", "Frm_Username");jslSetValue("Password", "Frm_Password", "SET");jslSetValue("Interface", "Frm_Interface");jslSetValue("Name", "Frm_Name");jslSetValue("Service", "Frm_Name");jslSetValue("DomainName", "Frm_DomainName");if(getValue("Frm_Name")=="dyndns"){setValue("IFservice_INDEX","1");}else if(getValue("Frm_Name")=="dipc"){setValue("IFservice_INDEX","0");}else if(getValue("Frm_Name")=="DtDNS"){setValue("IFservice_INDEX","2");}else if(getValue("Frm_Name")=="No-IP"){setValue("IFservice_INDEX","3");}}function pageCheckValue(){if(checkNull(getValue("Frm_Server")) != true){msg = getmsg(101);ShowErrorForCom("Frm_Server","Fnt_Server",msg);return false;}if(checkGenStringForASC(getValue("Frm_Server")) != true){msg = getmsg(114);ShowErrorForCom("Frm_Server","Fnt_Server",msg);return false;}var value = getValue("Frm_Server");if(checkStrLengthRange(value, 1, 256) != true){msg = getmsg(102,1,256);ShowErrorForCom("Frm_Server","Fnt_Server",msg);return false;}if(checkNull(getValue("Frm_Username")) != true){msg = getmsg(101);ShowErrorForCom("Frm_Username","Fnt_Username",msg);return false;}if(checkGenStringForASC(getValue("Frm_Username")) != true){msg = getmsg(114);ShowErrorForCom("Frm_Username","Fnt_Username",msg);return false;}var value = getValue("Frm_Username");if(checkStrLengthRange(value, 1, 256) != true){msg = getmsg(102,1,256);ShowErrorForCom("Frm_Username","Fnt_Username",msg);return false;}if(checkGenStringForASC(getValue("Frm_Password")) != true){msg = getmsg(114);ShowErrorForCom("Frm_Password","Fnt_Password",msg);return false;}var value = getValue("Frm_Password");if(checkStrLengthRange(value, 1, 256) == -3){msg = getmsg(102,1,256);ShowErrorForCom("Frm_Password","Fnt_Password",msg);return false;}if(getValue("Frm_Name")!="DtDNS"&& getValue("Frm_Name")!="No-IP"){if(checkNull(getValue("Frm_DomainName")) != true){msg = getmsg(101);ShowErrorForCom("Frm_DomainName","Fnt_DomainName",msg);return false;}var value = getValue("Frm_DomainName");if(checkStrLengthRange(value, 1, 64) != true){msg = getmsg(102,1,64);ShowErrorForCom("Frm_DomainName","Fnt_DomainName",msg);return false;}if(getValue("Frm_Name")=="dyndns"){if(checkDomainName(getValue("Frm_DomainName")) != true){msg = getmsg(106);ShowErrorForCom("Frm_DomainName","Fnt_DomainName",msg);return false;}}else if(getValue("Frm_Name")=="dipc"){if(checkDomainName(getValue("Frm_DomainName")) != true){msg = getmsg(104);ShowErrorForCom("Frm_DomainName","Fnt_DomainName",msg);return false;}}}return true;}function pageCancel(){jslDisable("Btn_Submit","Btn_Cancel");DisableALL();getObj("fSubmit").submit();}function pageSubmit(){if(pageCheckValue() == true){jslDisable("Btn_Submit","Btn_Cancel");pageSetValue();setValue("IF_ACTION", "apply");DisableALL();getObj("fSubmit").submit();}else {}}function Slect_Servise(){if(getValue("Frm_Name")=="dyndns"){document.getElementById("Fnt_DomainName").innerHTML="&?ddns006;";setValue("IFservice_INDEX","1");setValue("IF_NAME","dyndns");}else if(getValue("Frm_Name")=="dipc"){document.getElementById("Fnt_DomainName").innerHTML="&?ddns004;";setValue("IFservice_INDEX","0");setValue("IF_NAME","dipc");}else if(getValue("Frm_Name")=="DtDNS"){setValue("IFservice_INDEX","2");setValue("IF_NAME","DtDNS");}else if(getValue("Frm_Name")=="No-IP"){setValue("IFservice_INDEX","3");setValue("IF_NAME","No-IP");}jslSetValue("Name", "Frm_Name");jslSetValue("Service", "Frm_Name");setValue("IF_ACTION", "delete");DisableALL();getObj("fSubmit").submit();}</script>