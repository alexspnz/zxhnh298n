<%var login_monotonic_id = getenv("auth/login_monotonic_id");if (login_monotonic_id == "N/A"|| login_monotonic_id == ""){login_monotonic_id = 0;}%>DD_belatedPNG.fix('.png_bg');var cookieCacheUserFlag = 0;var maxErrLoginTimerHandle;var maxErrLoginLocalLeftSecond;<%if (get_config("pm_autojump") != "N"){%>function jump(){top.location.href = "/";}<%var restart_timeout, version_timeout, restore_timeout;restart_timeout = get_config("restart_relogin");version_timeout = get_config("version_relogin");restore_timeout = get_config("restore_relogin");if((restart_timeout == "N/A") || (restart_timeout == "NULL") || (restart_timeout IS NULL)){restart_timeout = 3;}if((version_timeout == "N/A") || (version_timeout == "NULL") || (version_timeout IS NULL)){version_timeout = 5;}if((restore_timeout == "N/A") || (restore_timeout == "NULL") || (restore_timeout IS NULL)){restore_timeout = 3;}%>function AutoRelogin(type){var timeout;if ((type == "restart") || (type == "upgconfig")){timeout = <%=restart_timeout;%>;}else if (type == "restore"){timeout = <%=restore_timeout;%>;}else if (type == "upgversion"){timeout = <%=version_timeout;%>;}else {return;}setTimeout("jump()", timeout*60*1000+5000);}<%}%>function show_tip_msg(msgtype, msgcontent){if($('#divErr').data("qtip")){$('#divErr').qtip("destroy");}$('#divErr').qtip({content: {title: {text: msgtype},text: msgcontent},position: {target: $('#divErr'),corner: 'top'},show: {when: false,ready: true},hide: 'unfocus',style: {width: 220,padding: '14px',border: {width: 5,radius: 5,color: '#02B9D3'},title: {background: '#185B86',color: 'red',fontSize: '1.2em'},background: '#29648C',color: '#fff',fontSize: '1.2em'}});$(".qtip").draggable();}function show_error_msg(msgcontent, ctlid){show_tip_msg("&?ErrRep;", msgcontent);}function show_note_msg(msgcontent, ctlid){show_tip_msg("&?NotRep;", msgcontent);}function errloginMaxNumTimer(){if ( maxErrLoginLocalLeftSecond > 0 ){var msgcontent = "&?1003;"+ maxErrLoginLocalLeftSecond + "&?login005;";$("#qtip60s").html(msgcontent);maxErrLoginLocalLeftSecond--;}else {if($('#divErr').data("qtip")){$('#divErr').qtip("destroy");}clearInterval(maxErrLoginTimerHandle);jslEnable("Frm_Login");$(document).keydown(function(event){if(event.keyCode == 13)$("#Frm_Login").click();});}}function OldProcessRet(errstr, errpara){if("&?cmret_101;"== errstr && "SUCC"== errpara){errstr = "FAIL";}ProcessRet(errstr, errpara);}function ProcessRet(errstr, errpara){var errtype=getValue("IF_ERRORTYPE");if (errstr != "SUCC"){if(errpara != "SUCC"){var param = document.getElementById("Fnt_"+errpara);if ( param== null){ShowErrorForCom(null, null, "&?cmret_001;");}else {msg = "&?cmret_101;"+ param.innerHTML + "&?cmret_102;";ShowErrorForCom("Frm_"+errpara, null, msg);}}else {if (errstr == "FAIL"){errstr = "&?cmret_001;";}if ((errtype&1) == 1){ShowNote("&?NotRep;", errstr);}else if((errtype&2) == 2){ShowErrorForCom(null, null, errstr);}else if((errtype&4) == 4){}else {ShowErrorForCom(null, null, errstr);}}}}function getBtnHTML(staFlag){var btnHtml = "";switch(staFlag){case 1:case 6:btnHtml += "<input name='Submit' type='button' id='Btn_ReFresh' onclick=pageReFresh() class='button' value='&?btn001;'/>";break;case 3:btnHtml += "<input name='Submit' type='button' id='Btn_Add' onclick=pageAdd()  class='button' value='&?btn002;'/>&nbsp;";btnHtml += "<input name='Submit' type='button' id='Btn_Cancel' onclick=pageCancel()  class='button' value='&?btn004;'>";btnHtml += "<input name='Submit' type='button' id='Btn_DoEdit' onclick=pageEdit()  class='button' value='&?btn003;' style='display:none'/>&nbsp;";btnHtml += "<input name='Submit' type='button' id='Btn_Delete' onclick=pageDel()  class='button' value='&?btn006;' style='display:none'/>";break;case 2:btnHtml += "<input name='Submit' type='button' id='Btn_Submit' onclick=pageSubmit()  class='button' value='&?btn005;'/>&nbsp;";btnHtml += "<input name='Submit' type='button' id='Btn_Cancel' onclick=pageCancel()  class='button' value='&?btn004;'/>";break;case 7:btnHtml += "<input name='Back' type='button' id='Btn_Back' onclick=pageBack()  class='button' value='&?btn013;'/>";break;case 8:btnHtml += "<input name='Submit' type='button' id='Btn_Back'   onclick=pageBack()  class='button' value='&?btn013;'/>&nbsp;";btnHtml += "<input name='Submit' type='button' id='Btn_Submit' onclick=pageSubmit()  class='button' value='&?btn005;'/>&nbsp;";btnHtml += "<input name='Submit' type='button' id='Btn_Cancel' onclick=pageCancel()  class='button' value='&?btn004;'/>";break;default:break;}return btnHtml;}function AccountLogout(){setValue("TPAction", "ACTION_LOGOUT");getObj("TPfSubmit").submit();}function relogin(){alert("&?note_003;");AccountLogout();}function overtime(){<%setenv("request/callback", "relogin()");IMPORT FILE "auth/timeout_ctl_js.gch";%>}function langChineseHighLight(){$("#LANG_Chinese").find(".LANG_CONTENT").css({"background-color":"#01263D"});$("#LANG_Chinese").find(".LANG_ARROW").css({"background-color":"#01263D"});$("#LANG_Chinese").find(".LANG_ARROW").find("img").attr("src","img/menuArrow_w.gif");$("#LANG_Chinese").fadeTo("fast",1);$("#LANG_English").find(".LANG_CONTENT").css({"background-color":"#00437F"});$("#LANG_English").find(".LANG_ARROW").css({"background-color":"#00437F"});$("#LANG_English").find(".LANG_ARROW").find("img").attr("src","img/menuArrow.gif");$("#LANG_English").fadeTo("fast",0.8);}function langEnglishHighLight(){$("#LANG_English").find(".LANG_CONTENT").css({"background-color":"#01263D"});$("#LANG_English").find(".LANG_ARROW").css({"background-color":"#01263D"});$("#LANG_English").find(".LANG_ARROW").find("img").attr("src","img/menuArrow_w.gif");$("#LANG_English").fadeTo("fast",1);$("#LANG_Chinese").find(".LANG_CONTENT").css({"background-color":"#00437F"});$("#LANG_Chinese").find(".LANG_ARROW").css({"background-color":"#00437F"});$("#LANG_Chinese").find(".LANG_ARROW").find("img").attr("src","img/menuArrow.gif");$("#LANG_Chinese").fadeTo("fast",0.8);}function getArrLen(arr){var len = 0;for (var i in arr){len++;}return len;}$(function() {if (getValue("TPNextpage") == "welcome.gch"){$("#content_left_circle").css("background", "url(img/content_left_circle_fp.gif)");$("#content_left").css("background", "url(img/content_left_bg_fp.gif)");}else {$("#content_left_circle").css("background","url(img/content_left_circle.gif)");$("#content_left").css("background","url(img/content_left_bg.gif)");}var metaMenuHTML = "";var selectPage = $("#TPNextpage").val();for (var supId in meta_menu){if ( 0 == getArrLen(menu_items[supId]) ){metaMenuHTML += "<li id='meta_menu_"+ supId + "' onclick=\"location='" + meta_menu[supId]['URL'] + "';\" class=\"rootVoice {menu: 'empty'}\">"+ meta_menu[supId]['langName'] + "</li>";if (meta_menu[supId]['page'] == selectPage){$("#title_path").text("&?path001;"+ meta_menu[supId]['langName']);}}else {metaMenuHTML += "<li id='meta_menu_"+ supId + "' class=\"rootVoice {menu: '" + supId + "'}\">"+ meta_menu[supId]['langName'] + "</li>";var menuItemHTML = "<div id='"+ supId + "' class='mbmenu'>";for (var midId in menu_items[supId]){if ( 0 == getArrLen(menu_subitems[supId][midId]) ){menuItemHTML += "<a href='"+ menu_items[supId][midId]['URL'] + "'>"+ menu_items[supId][midId]['langName'] + "</a>";if (menu_items[supId][midId]['page'] == selectPage){$("#title_path").text("&?path001;"+ meta_menu[supId]['langName'] + "-"+ menu_items[supId][midId]['langName']);}}else {menuItemHTML += "<a class=\"{menu: '" + midId + "'}\">"+ menu_items[supId][midId]['langName'] + "</a>";var submenuItemHTML = "<div id='"+ midId + "' class='mbmenu'>";for (var subId in menu_subitems[supId][midId]){submenuItemHTML += "<a href='"+ menu_subitems[supId][midId][subId]['URL'] + "'>"+ menu_subitems[supId][midId][subId]['langName'] + "</a>";if (menu_subitems[supId][midId][subId]['page'] == selectPage){$("#title_path").text("&?path001;"+ meta_menu[supId]['langName'] + "-"+ menu_items[supId][midId]['langName'] + "-"+ menu_subitems[supId][midId][subId]['langName']);}}submenuItemHTML += "</div>";$("#navigation").append(submenuItemHTML);}}menuItemHTML += "</div>";$("#navigation").append(menuItemHTML);}}$(".myMenu").find("ul").append( metaMenuHTML );if ( "1"!= getValue("TPIsLogin") ){$("#meta_menu_mmWelcome").text("&?menuWlc;");}$("#meta_menu_"+ getValue("TPNextpageSupId")).addClass("selected");$(".myMenu").buildMenu({template:"",additionalData:"pippo=1",menuWidth:100,openOnRight:false,menuSelector: ".menuContainer",containment:"wrapper",hasImages:false,fadeInTime:100,fadeOutTime:0,adjustLeft:2,minZindex:"auto",adjustTop:10,opacity:.9,shadow:false,openOnClick:false,closeOnMouseOut:true,closeAfter:200,currentMainMenu:("meta_menu_"+ getValue("TPNextpageSupId"))});$("#languageMgr").click(function() {if ( "Chinese"== getValue("TPLanguage") ){langChineseHighLight();}else {langEnglishHighLight();}$("#languageList").toggle();});$("#languageEntity").hover(function(){}, function(){$("#languageList").hide();});$("#logoff").click(function(){DisableALL();AccountLogout();});$("#Frm_Logout").click(function(){DisableALL();AccountLogout();});$("#Frm_Login").click(function(){if (getValue("Frm_Username") == ""){show_error_msg("&?1001;");}else {DisableALL();if ( 0 == cookieCacheUserFlag ){setCookie('gateway_username',"",0);setCookie('gateway_password',"",0);}else {setCookie('gateway_username', getValue("Frm_Username"), 90);setCookie('gateway_password', encode64(getValue("Frm_Password")), 90);}jslSetValue("TPUsername", "Frm_Username");jslSetValue("TPPassword", "Frm_Password");setValue("TPAction", "ACTION_USERLOGIN");setValue("Frm_Logintoken", "<%=login_monotonic_id;%>");getObj("TPfSubmit").submit();}});$("#LANG_Chinese").hover(function(){langChineseHighLight();},function(){});$("#LANG_English").hover(function(){langEnglishHighLight();},function(){});$("#LANG_Chinese").click(function(){DisableALL();$("#languageList").hide();setValue("TPLanguage", "Chinese");setValue("TPAction", "ACTION_LANGSET");getObj("TPfSubmit").submit();});$("#LANG_English").click(function(){DisableALL();$("#languageList").hide();setValue("TPLanguage", "English");setValue("TPAction", "ACTION_LANGSET");getObj("TPfSubmit").submit();});var staflag = parseInt(getValue("TPNextpageStaFlag"), 10);$("#div_common_button").html(getBtnHTML(staflag));if (getBtnHTML(staflag) != ""){$("#pageContent").css("height", "340px");}else {$("#div_common_button").hide();}if ( "1"!= getValue("TPIsLogin") ){var username = getCookie('gateway_username');if (username!=null && username!=""){var password = getCookie('gateway_password');if ( null != password ){password = decode64(password);}else {password = "";}setValue("Frm_Username", username);setValue("Frm_Password", password);cookieCacheUserFlag = 1;setChecked("Frm_SaveFlg", true);}else {setChecked("Frm_SaveFlg", false);}$("#lblLogin, #divLogin").show();var errLoginNum = getValue("TPErrLoginNum");var errLoginNumMax = getValue("TPErrLoginNumMAX");maxErrLoginLocalLeftSecond = 60 - getValue("TPErrLoginTimeElapse");if ( (errLoginNum >= errLoginNumMax) && (maxErrLoginLocalLeftSecond > 0) ){jslDisable("Frm_Login");var msgcontent = "&?1003;"+ maxErrLoginLocalLeftSecond + "&?login005;";$('#divErr').qtip({content: {title: {text: "&?ErrRep;"},text: msgcontent,textid: "qtip60s"},position: {target: $('#divErr'),corner: 'top'},show: {when: false,ready: true},hide: false,style: {width: 220,padding: '14px',border: {width: 5,radius: 5,color: '#02B9D3'},title: {background: '#185B86',color: 'red',fontSize: '1.2em'},background: '#29648C',color: '#fff',fontSize: '1.2em'}});$(".qtip").draggable();maxErrLoginTimerHandle = setInterval("errloginMaxNumTimer()",1000);}else {$(document).keydown(function(event){if(event.keyCode == 13)$("#Frm_Login").click();});var login_err_msg = $(window.top.document).find("#login_err_msg").text();if (login_err_msg){show_error_msg(login_err_msg, null);}else if ( "ACTION_USERLOGIN"== getValue("TPActionPre") ){show_error_msg("&?1002;", null);}}}else {$("#lblLogout, #logoff").show();<%if ( get_config("help")=="Y"){%>$("#lblLogout_div, #lblHelp").show();if ( "welcome.gch"== getValue("TPNextpage") ){$("#divLogout").show();$("#ttLogout").css("color", "#000");}else {$("#divHelp").show();$("#ttHelp").css("color", "#000");}<%}else {%>$("#divLogout").show();<%}%>var username = getValue("TPUsername");if ( username.length > 8 ){username = username.substring(0, 8) + "...";}username = HTMLEnCode( username );$("#span_wlc_username").html(username);$("#span_curr_username").html(username);if ( "Chinese"== getValue("TPLanguage") ){$(".span_space").hide();}}$("#lblLogin").click(function(){$("#divLogin").show();$("#divHelp, #divLogout").hide();});$("#lblLogout").click(function(){$("#ttLogout").css("color", "#000");$("#ttHelp").css("color", "#007899");$("#divLogout").show();$("#divHelp, #divLogin").hide();});$("#lblHelp").click(function(){$("#ttLogout").css("color", "#007899");$("#ttHelp").css("color", "#000");$("#divLogin, #divLogout").hide();$("#divHelp").show();});$('#Frm_SaveFlg').click(function(){if ( getChecked("Frm_SaveFlg") == true ){cookieCacheUserFlag = 1;}else {cookieCacheUserFlag = 0;}});<%if ("DBSaveTimeout"== getenv("g_systemBusyStatus")){unsetenv("g_systemBusyStatus");%>try{var clds = parent.document.getElementById("fSubmit").childNodes;for (var i=0; i<clds.length; i++){var nodeName = clds[i].nodeName;if (nodeName.match(/Input/i) != null){try{setValue(clds[i].id, clds[i].value);}catch(e){appendHiddenInput("fSubmit", clds[i].id, clds[i].value);}}}}catch(e){}<%}%>try{pageLoad(getURL(getValue("TPNextpage")));}catch(e){}if ( 1 == getValue("TPIsLogin") ){overtime();}});