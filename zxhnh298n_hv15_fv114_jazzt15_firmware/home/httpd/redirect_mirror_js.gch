<script language="javascript">var MIRROR_PARA = new Array("MirrorEnable","MirrorSrc","MirrorDest");var MIR_PARA = new Array("Mirror_Enable","Mirror_Src","Mirror_Dest");var IPv6Ctr = "<%=getenv("DevIPv6Effect");%>";function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(118, "&?error_118;");str[2] = new Array(119, "&?error_119;");str[3] = new Array(122, "&?error_122;");str[4] = new Array(127, "&?error_127;");return getMsgFormArray(str, arguments) }function MirrorProcessRet(errstr, errpara){if("SUCC"!= errstr){alert("&?cmret_001;");}}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");if("&?cmret_002;"== errstr){errstr = "&?cmret_001;";}showTable();MirrorProcessRet(errstr, errpara);}function getImage(src, strmethod,id){return ("<input type=\"button\" id=\""+id+"\"  onclick=\""+ strmethod +"\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("+src+");\">");}function getNameValue(id, size, value){return ("<input type=\"text\" class=\"uiNoBorder\" size=\"" + size +"\" value=\""
+ value + "\"  id=\"" + id + "\"  readonly>");}function addline(index){var newline = getObj("Dhcp_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");var cellId;var cellSize=15;var cellValue="";for(var i = 0; i < MIR_PARA.length ; i++){cellId = "Line_"+ index + "_"+ MIR_PARA[i] + "_"+ i;cellValue = getValue(MIR_PARA[i]+index);if(0 == i){newline.insertCell(-1).innerHTML = showIsEnableImage(cellValue, cellId);}else {newline.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, cellValue);}}newline.insertCell(-1).innerHTML=getImage("img/button_modify.gif", "Modify("+index+")", "Btn_Modify"+index);newline.insertCell(-1).innerHTML=getImage("img/button_delete.gif", "Delete("+index+")", "Btn_Delete"+index);}function showTable(){var num = getValue("IF_INSTNUM");if(num != 0 ){for(var i = 0; i < num; i++){if(getValue("IpMode"+i)== 2&& IPv6Ctr==0)continue;addline(i);}}else {var newline = getObj("Dhcp_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");newline.setAttribute("border", "1px solid black");var objcell = newline.insertCell(-1);objcell.colSpan = 5;objcell.innerHTML= "&?note_007;"}if(num >0){var flag = 0;if(IPv6Ctr==0){for(var i = 0; i < num; i++){if(getValue("IpMode"+i)== 2){flag ++;}}if(flag == num){var newline = getObj("Dhcp_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);objcell.colSpan = 5;objcell.innerHTML= "&?note_007;"}}}}function MacSetValue(){}function ModifyGetValue(i){jslSetValue("Frm_MirrorSrc", "MirrorSrc"+i);jslSetValue("Frm_MirrorDest", "MirrorDest"+i);var tem = getValue("MirrorEnable"+i);if (tem == 1)getObj("Frm_MirrorEnable").checked = true;else getObj("Frm_MirrorEnable").checked = false;}function pageSetValue(){HiddenParaInit(MIRROR_PARA);jslSetValue("MirrorSrc", "Frm_MirrorSrc");jslSetValue("MirrorDest", "Frm_MirrorDest");if (getObj("Frm_MirrorEnable").checked == true){setValue("MirrorEnable",1);}else {setValue("MirrorEnable",0);}}function pageCheckValue(){return true;}function Add(){var number = getValue("IF_INSTNUM");document.getElementById("add").style.display="";document.getElementById("modify").style.display="none";if(pageCheckValue() == true){for(var i = 0; i < number; i++){if(getValue("IpMode"+i)==2 && IPv6Ctr==0){continue;}else {jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}}jslDisable("add","modify");pageSetValue();setValue("IF_ACTION", "new");setValue("IF_INDEX", "-1");DisableALL();getObj("fSubmit").submit();}else {}}function Modify(i){document.getElementById("add").style.display="none";document.getElementById("modify").style.display="";document.getElementById("back").style.display="";ModifyGetValue(i);index=i;}function ModifySubmit(){var number = getValue("IF_INSTNUM");if(pageCheckValue() == true){for(var i = 0; i < number; i++){if(getValue("IpMode"+i)== 2&& IPv6Ctr==0)continue;jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}jslDisable("add","modify", "back");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_INDEX",index);DisableALL();getObj("fSubmit").submit();}else {}}function Delete(i){var number = getValue("IF_INSTNUM");setValue("IF_ACTION", "delete");setValue("IF_INDEX",i);jslDisable("add","modify", "back");for(var i = 0; i < number; i++){if(getValue("IpMode"+i)== 2&& IPv6Ctr==0)continue;jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}DisableALL();getObj("fSubmit").submit();}function back4add(){var number = getValue("IF_INSTNUM");jslDisable("add","modify", "back");for(var i = 0; i < number; i++){if(getValue("IpMode"+i)== 2&& IPv6Ctr==0)continue;jslDisable("Btn_Modify"+ i);jslDisable("Btn_Delete"+ i);}DisableALL();getObj("fSubmit").submit();}</script>