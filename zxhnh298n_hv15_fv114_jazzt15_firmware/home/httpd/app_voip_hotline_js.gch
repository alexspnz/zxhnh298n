<script language="javascript">var PHYCALLCONFIG_PARA = new Array("DelayHotLine");var PHYCALLCONFIG_TEXT_PARA = new Array("&?voip_hotline_004;");var PHYCALLCONFIG_HTML_ID = new Array("Frm_Delay_HotLine");var HLNumber_PARA = new Array("HLNumber");var HLNumber_TEXT_ID = new Array("&?voip_hotline_005;");var HLNumber_HTML_ID = new Array("Frm_HLNumber");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(102, "&?error_102;");str[2] = new Array(103, "&?error_103;");str[3] = new Array(115, "&?error_115;");str[4] = new Array(116, "&?error_116;");str[5] = new Array(117, "&?error_117;");str[6] = new Array(118, "&?error_118;");str[7] = new Array(232, "&?error_232;");return getMsgFormArray(str, arguments);}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");ProcessRet(errstr, errpara);ShowTable();}function pageSetValue(){var dhlTimer = getValue("Frm_DhlTimer");dhlTimer = dhlTimer*100;setValue("DhlTimer", dhlTimer);var allInstNum = getValue("IF_INSTNUM");var phyleng = PHYCALLCONFIG_TEXT_PARA.length;var hlnleng = HLNumber_TEXT_ID.length;for(var i = 0; i < allInstNum; i++){for (var j = 0; j < phyleng; j++){jslViewToPostCheckBox(PHYCALLCONFIG_PARA[j]+i,PHYCALLCONFIG_HTML_ID[j]+i);}for (var j = 0; j < hlnleng; j++){jslSetValue(HLNumber_PARA[j]+i,HLNumber_HTML_ID[j]+i);}}}function checkNum(frm_id, fnt_id, isNull, minValue, maxValue){var msg = "";if( 0 == isNull && false == checkNull(getValue(frm_id)) ){return true;}var numCheck = checkIntegerRange(getValue(frm_id), minValue, maxValue);if("-1"== numCheck){msg = getmsg(101);ShowErrorForCom(frm_id, fnt_id, msg);return false;}if("-2"== numCheck){msg = getmsg(115);ShowErrorForCom(frm_id, fnt_id, msg);return false;}else if("-3"== numCheck){msg = getmsg(116, minValue, maxValue);ShowErrorForCom(frm_id, fnt_id, msg);return false;}return true;}function checkHLNumber(index){var hlNum = getValue("Frm_HLNumber"+index);var msg = "";var len = hlNum.length;if ((len < 0) || (len > 32)){msg = getmsg(102, 0, 32);ShowErrorForCom("Frm_HLNumber"+index, "Fnt_HLNumber"+index, msg);return false;}if (hlNum.match("[^0-9*#]") != null){msg = getmsg(232);ShowErrorForCom("Frm_HLNumber"+index, "Fnt_HLNumber"+index, msg);return false;}return true;}function pageCheckValue(){if (false == checkNum("Frm_DhlTimer", "Fnt_DhlTimer", 1, 1, 14)){return false;}var num = getValue("IF_INSTNUM");for(var i = 0; i < num; i++){if (true != checkHLNumber(i)){return false;}}return true;}function pageSubmit(){if(pageCheckValue() == true){jslDisable("Btn_Submit","Btn_Cancel");pageSetValue();setValue("IF_ACTION", "apply");DisableALL();getObj("fSubmit").submit();}}function pageCancel(){jslDisable("Btn_Submit","Btn_Cancel");DisableALL();getObj("fSubmit").submit();}function setWhiteLine(index){for(var i=0;i<index;i++){var newline = getObj("TestContent").insertRow(-1);var tdl=newline.insertCell(-1);}}function getCheckbox(id,value){if(value == 1){return ("<input type=\"checkbox\" align=\"right\" name=\"checkbox\" id=\""+id+"\"   checked >");}else {return ("<input type=\"checkbox\" align=\"right\" id=\""+id+"\">");}}function getTxtInput(id, value, tipHtml){if (tipHtml == ""){return ("<input type=\"text\" align=\"right\" name=\""+id+"\" id=\""+id+"\" value=\""+ value+"\" >");}else {return ("<input type=\"text\" align=\"right\" name=\""+id+"\" id=\""+id+"\" value=\""+ value+"\" >"+ tipHtml);}}function getFont(id, value){return ("<font id=\""+ id + "\">"+ value + "</font>");}function addPriorityLine(index, txt, id, hiddId, inputType){var newline = getObj("TestContent").insertRow(-1);var tdl=newline.insertCell(-1);tdl.setAttribute("className", "td1");tdl.setAttribute("class", "td1");tdl.setAttribute("align", "right");tdl.setAttribute("id", "Fnt_CODECTYPE"+ index );tdl.innerHTML = getFont("Fnt_"+ hiddId + index, txt);var tdr = newline.insertCell(-1);tdr.setAttribute("className", "td2");tdr.setAttribute("class", "td2");tdl.setAttribute("align", "left");if (inputType == "checkbox"){tdr.innerHTML = getCheckbox((id + index), getValue(hiddId+index));}else if (inputType == "input"){tdr.innerHTML = getTxtInput((id + index), getValue(hiddId+index), "(*, #, 0~9)");}else {}}function showPhoneLine(index){if(index != 0){setWhiteLine(20);}var newline = getObj("TestContent").insertRow(-1);var inttmp = parseInt(index) + parseInt(1);var id,leng;var newline = getObj("TestContent").insertRow(-1);newline.setAttribute("className", "td1_1");newline.setAttribute("class", "td1_1");newline.insertCell(-1).innerHTML = "<B>&?media_11;"+inttmp+"</B>";newline.insertCell(-1);phyleng = PHYCALLCONFIG_HTML_ID.length;for (var j = 0; j < phyleng; j++){addPriorityLine(index,PHYCALLCONFIG_TEXT_PARA[j], PHYCALLCONFIG_HTML_ID[j], PHYCALLCONFIG_PARA[j], "checkbox");}hlnleng = HLNumber_HTML_ID.length;for (var j = 0; j < hlnleng; j++){addPriorityLine(index,HLNumber_TEXT_ID[j], HLNumber_HTML_ID[j], HLNumber_PARA[j], "input");}}function ShowTable(){var dhlTimer = getValue("DhlTimer");dhlTimer = dhlTimer/100;setValue("Frm_DhlTimer", dhlTimer);var num = getValue("IF_INSTNUM");for(var i = 0; i < num; i++){showPhoneLine(i);}}</script>