<%IMPORT FILE "common_gch.gch";var FP_ACTION, FP_IDENTITY, FP_HANDLE, FP_INDEX, FP_OBJNAME, FP_ERRORSTR, FP_ERRORTYPE;var FP_MULTIDISPLAY, FP_INSTNUM, FP_INSTNUM_PPP,FP_PARANUM, FP_ERRORPARAM,wanc_name,WANNAME;var PARA[5] ={"WANCName","StrServList","UserName","Password","ATMLinkType"};FP_OBJNAME = "OBJ_DSLWANCPPP_ID";FP_PARANUM = 5;FP_IDENTITY = "";FP_INSTNUM_PPP = 0;wanc_name = request("IF_NAME");FP_INDEX = request("IF_INDEX");if (FP_INDEX IS NULL){FP_INDEX = -1;}FP_MULTIDISPLAY = request("IF_MULTIDISPLAY");if (FP_MULTIDISPLAY IS NULL){FP_MULTIDISPLAY = -1;}FP_ACTION = request("IF_ACTION");FP_INSTNUM = query_list("OBJ_DSLWANCPPP_ID", "IGD");if(FP_INSTNUM != 888 && FP_INSTNUM >0 && FP_INDEX >=0 && FP_ACTION != "new"){for(var i = 0; i < FP_INSTNUM; i++ ){WANNAME = query_name(i);if (wanc_name == WANNAME){FP_IDENTITY = query_identity(i);break;}}}if (FP_ACTION == "apply"){if (FP_INSTNUM == 888 ){create_hidden_sep("applyinsum888", FP_INSTNUM);FP_HANDLE = create_paralist();for(var i=0; i< FP_PARANUM; i++){setpara(FP_HANDLE, PARA[i]);}FP_IDENTITY = set_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);}else {FP_HANDLE = create_paralist();for(var i=0; i< FP_PARANUM; i++){set_multiinst_para(FP_HANDLE, PARA[i], FP_INDEX);}FP_IDENTITY = set_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);}}create_form_start("fSubmit", "");createHigherHidden(FP_INDEX);if(FP_INSTNUM == 888){FP_HANDLE = create_paralist();get_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);create_hidden_para(FP_HANDLE, PARA, FP_PARANUM);destroy_paralist(FP_HANDLE);}else {FP_INSTNUM = query_list("OBJ_DSLWANCPPP_ID", "IGD");for(var i = 0; i < FP_INSTNUM; i++ ){var type=query_wanctype(i);if (type=="pppoe"){FP_HANDLE = create_paralist();var identity = query_identity(i);get_inst(FP_HANDLE, FP_OBJNAME, identity);var LinkType = get_para(FP_HANDLE, "ATMLinkType");if (LinkType != "PPPoA"){var WAN_ServList = get_para(FP_HANDLE, "StrServList");var wanc_name =get_para(FP_HANDLE, "WANCName");var UserName =get_para(FP_HANDLE, "UserName");var Password =get_para(FP_HANDLE, "Password");create_hidden_sep("IF_WANNAME"+FP_INSTNUM_PPP, wanc_name);create_hidden_sep("IF_WANCName"+FP_INSTNUM_PPP, wanc_name);create_hidden_sep("IF_WANIDENTITY"+FP_INSTNUM_PPP, identity);create_hidden_sep("UserName"+FP_INSTNUM_PPP, UserName);create_hidden_sep("Password"+FP_INSTNUM_PPP, Password);create_hidden_sep("StrServList"+FP_INSTNUM_PPP, WAN_ServList);create_hidden_sep("ATMLinkType"+FP_INSTNUM_PPP, LinkType);var num0 = substr(identity,6,7);var num1 = substr(identity,11,12);var num2 = substr(identity,18,19);var FP_UsernameATTR = attr("InternetGatewayDevice.WANDevice."+num0+".WANConnectionDevice."+num1+".WANPPPConnection."+num2+".Username");var FP_PasswordATTR = attr("InternetGatewayDevice.WANDevice."+num0+".WANConnectionDevice."+num1+".WANPPPConnection."+num2+".Password");create_hidden_sep("IF_UsernameATTR"+FP_INSTNUM_PPP , FP_UsernameATTR);create_hidden_sep("IF_PasswordATTR"+FP_INSTNUM_PPP , FP_PasswordATTR);FP_INSTNUM_PPP++;}destroy_paralist(FP_HANDLE);}}}getDisplayInstError("SUCC");create_hidden_sep("IF_MULTIDISPLAY", FP_MULTIDISPLAY);set_hidden("IF_INSTNUM", FP_INSTNUM);create_hidden_sep("IF_INSTNUM_PPP",FP_INSTNUM_PPP);create_hidden_sep("IF_NAME", "");create_form_end();%>