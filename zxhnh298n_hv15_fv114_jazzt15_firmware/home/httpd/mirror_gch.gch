<%IMPORT FILE "common_gch.gch";var FP_ERRORSTR = "SUCC";var FP_OBJNAME = "OBJ_MIRROR_ID";var FP_PARANUM = 3;var FP_INDEX = getInstIndex("new");var FP_MULTIDISPLAY = 1;var FP_HANDLE;var PARA[3] ={"MirrorEnable","MirrorSrc","MirrorDest"};var FP_ACTION = request("IF_ACTION");create_form_start("fSubmit", "");createSubmitHidden(FP_MULTIDISPLAY, PARA, FP_PARANUM, FP_INDEX);var FP_IDENTITY = getInstIdentityByAction(FP_OBJNAME, FP_MULTIDISPLAY, FP_ACTION, FP_INDEX);FP_ERRORSTR = applyOrNewOrDelInst(FP_OBJNAME, FP_ACTION, FP_IDENTITY, PARA, FP_PARANUM, FP_ERRORSTR);var LAN_HANDLE,WanName,LanName,Mirror_Src,Mirror_Dest,Mirror_Enable;var FP_INSTNUM = query_list(FP_OBJNAME, "IGD");if (FP_MULTIDISPLAY == 1){for (var i=0; i<FP_INSTNUM; i++){FP_HANDLE = create_paralist();FP_IDENTITY = query_identity(i);get_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);Mirror_Enable=get_para(FP_HANDLE, "MirrorEnable");Mirror_Src =get_para(FP_HANDLE, "MirrorSrc");Mirror_Dest=get_para(FP_HANDLE, "MirrorDest");var IpMode = get_IPMode(Mirror_Src);create_hidden_sep("IpMode"+i, IpMode);create_hidden_multiinstpara(FP_HANDLE, PARA, i, FP_PARANUM);destroy_paralist(FP_HANDLE);create_hidden_sep("Mirror_Enable"+i, Mirror_Enable);LAN_HANDLE = create_paralist();get_inst(LAN_HANDLE, "OBJ_WANLAN_ID", Mirror_Src);WanName= get_para(LAN_HANDLE, "Name");create_hidden_sep("Mirror_Src"+i, WanName);destroy_paralist(LAN_HANDLE);LAN_HANDLE = create_paralist();get_inst(LAN_HANDLE, "OBJ_WANLAN_ID", Mirror_Dest);LanName = get_para(LAN_HANDLE, "Name");create_hidden_sep("Mirror_Dest"+i, LanName);destroy_paralist(LAN_HANDLE);}}getDisplayInstError(FP_ERRORSTR);set_hidden("IF_INSTNUM", FP_INSTNUM);create_form_end();%>