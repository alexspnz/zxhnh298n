<%IMPORT FILE "common_gch_zxy.gch";IMPORT FILE "common_gch.gch";function homeline_func(FP_ACTION, FP_INDEX, FP_ERRORSTR){var FP_OBJNAME = "OBJ_VOIPHOMELINE_ID";var FP_PARANUM = 2;var FP_MULTIDISPLAY = 1;var FP_PARA[2] ={"Enable","OutByWanId"};var FP_INSTNUM, FP_HANDLE, FP_IDENTITY="";var OBJNAME = FP_OBJNAME + "_";create_hidden_newpara_zxy(OBJNAME, FP_PARA, FP_PARANUM);if(FP_ACTION == "apply"){if(FP_INDEX == -1){FP_INSTNUM = query_list(FP_OBJNAME, "IGD");for(var index = 0 ; index < FP_INSTNUM ; index++){FP_IDENTITY = query_identity(index);FP_HANDLE = create_paralist();set_para(FP_HANDLE, "OutByWanId", request(OBJNAME+"OutByWanId"+index));FP_IDENTITY = set_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);}}else if(FP_INDEX >= 0){FP_INSTNUM = query_list(FP_OBJNAME, "IGD");FP_IDENTITY = query_identity(FP_INDEX);for(var i=0; i< FP_PARANUM; i++){setpara_zxy(FP_HANDLE, OBJNAME, FP_PARA[i]);}FP_IDENTITY = set_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);}}create_hidden_sep_zxy("IF_HL_INSTNUM", query_list(FP_OBJNAME, "IGD"));FP_ERRORSTR = getNewInstError_zxy(FP_ERRORSTR);return displayFunctionInst_zxy(FP_OBJNAME, FP_MULTIDISPLAY, FP_PARA, FP_PARANUM, FP_ERRORSTR);}%>