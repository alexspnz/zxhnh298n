<script language="javascript">var CONFIG_PARA = new Array("Enable","RadioStatus","Standard","BeaconInterval","RtsCts","Fragment","DTIM","TxPower","CountryCode","TxRate","Channel","ESSID","ESSIDPrefix","ACLPolicy","BeaconType","WEPAuthMode","WEPEncryptionLevel","WEPKeyIndex","WPAAuthMode","WPAEncryptType","WPAGroupRekey","WPAEAPServerIp","RadiusPort","RadiusServerPort","WPAEAPSecret","PossibleChannels","BasicDataRates","OpDataRates","PossibleTxRates","OOBAccessEnabled","BeaconEnabled","ESSIDHideEnable","RegulatoryDomain","WlanMode","DistanceFromRoot","PeerBSSID","AuthServiceMode","QosType","Priority","UAPSDEnabled","AutoChannelEnabled","ChannelsInUse","11iAuthMode","11iEncryptType","MaxUserNum","SSIDIsolationEnable","VapIsolationEnable","Band","11nMode","BandWidth","SideBand","11nRate","SGIEnabled","GreenField");var b_rate = new Array("1","2","5.5","11");var g_bg_rate = new Array("1","2","5.5","11","6","9","12","18","24","36","48","54");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(102, "&?error_102;");str[2] = new Array(103, "&?error_103;");str[3] = new Array(113, "&?error_113;");str[4] = new Array(115, "&?error_115;");str[5] = new Array(116, "&?error_116;");str[6] = new Array(117, "&?error_117;");str[7] = new Array(118, "&?error_118;");str[8] = new Array(119, "&?error_119;");str[9] = new Array(122, "&?error_122;");return getMsgFormArray(str, arguments);}function PageUpdate(){var datarates=getValue("Frm_DataRates");var sidebandobj = getObj("Frm_SideBand");var channelobj = getObj("Frm_Channel");var userClass;var channel_list;var channel = getValue("Frm_Channel");if(getValue("Frm_CountryCode") == "caI"|| getValue("Frm_CountryCode") == "usI"){channel_list = "1,2,3,4,5,6,7,8,9,10,11";}else {channel_list = "1,2,3,4,5,6,7,8,9,10,11,12,13";}var parts = channel_list.split(",");userClass = new Array;for (var i = 0; i < parts.length; i++){userClass[i] = parts[i];}channelobj.length = parts.length+1;channelobj.options[0] = new Option("&?wan022;","Auto");for(var i=0; i<parts.length; i++){channelobj.options[i+1] = new Option(userClass[i],userClass[i]);}if(channel == ""){if((getValue("AutoChannelEnabled") == "1") || (getValue("Channel") == "") || (getValue("Channel") == "0")){setValue("Frm_Channel", "Auto");}else {jslSetValue("Frm_Channel","Channel");}}else {for(var i=0; i<channelobj.length; i++){if ( channel == channelobj.options[i].text){setValue("Frm_Channel", channel);break;}}if (i==channelobj.length){setValue("Frm_Channel", "Auto");}}if (getValue("Frm_CountryCode") == "brI"){setValue("Frm_DataRates", "b");}var channel = getValue("Frm_Channel");var sideband = getValue("Frm_SideBand");if (getValue("Frm_CountryCode") == "caI"|| getValue("Frm_CountryCode") == "usI"){if ((channel == "1") || (channel == "2") || (channel == "3") || (channel == "4")){sidebandobj.length = 1;sidebandobj.options[0] = new Option("Lower","Lower");setValue("Frm_SideBand","Lower");}else if ((channel == "8") || (channel == "9") || (channel == "10") || (channel == "11")){sidebandobj.length = 1;sidebandobj.options[0] = new Option("Upper","Upper");setValue("Frm_SideBand","Upper");}else if ((channel == "5") || (channel == "6") || (channel == "7")){sidebandobj.length = 2;sidebandobj.options[0] = new Option("Lower","Lower");sidebandobj.options[1] = new Option("Upper","Upper");if (sideband == ""){jslSetValue("Frm_SideBand","SideBand");}else {setValue("Frm_SideBand",sideband);}}}else {if ((channel == "1") || (channel == "2") || (channel == "3") || (channel == "4")){sidebandobj.length = 1;sidebandobj.options[0] = new Option("Lower","Lower");setValue("Frm_SideBand","Lower");}if ((channel == "10") || (channel == "11") || (channel == "12") || (channel == "13")){sidebandobj.length = 1;sidebandobj.options[0] = new Option("Upper","Upper");setValue("Frm_SideBand","Upper");}if ((channel == "5") || (channel == "6") || (channel == "7") || (channel == "8") || (channel == "9")){sidebandobj.length = 2;sidebandobj.options[0] = new Option("Lower","Lower");sidebandobj.options[1] = new Option("Upper","Upper");if (sideband == ""){jslSetValue("Frm_SideBand","SideBand");}else {setValue("Frm_SideBand",sideband);}}}if ((getValue("Frm_DataRates") == "n") || (getValue("Frm_DataRates") == "g,n")|| (getValue("Frm_DataRates") == "b,g,n")){jslEnDisplay("11n_BandWidth", "11n_SGIEnabled");if ((getValue("Frm_BandWidth") == "40Mhz") && (getValue("Frm_Channel") != "Auto")){jslEnDisplay("11n_SideBand");}else {jslDiDisplay("11n_SideBand");}jslDiDisplay("tr_fragment");jslSetValue("Frm_Fragment","Fragment");}else {jslDiDisplay("11n_BandWidth", "11n_SideBand", "11n_SGIEnabled");jslEnDisplay("tr_fragment");}}function SubParaGetValue(){if(getValue("SSIDIsolationEnable") == "1"){setChecked("Frm_SSIDIsolationEnable", true);}else {setChecked("Frm_SSIDIsolationEnable", false);}jslSetValue("Frm_DataRates", "Standard");if(getValue("CountryCode") == ""){setValue("Frm_CountryCode", "cnI");}else {jslSetValue("Frm_CountryCode","CountryCode");}if((getValue("AutoChannelEnabled") == "1") || (getValue("Channel") == "") || (getValue("Channel") == "0")){setValue("Frm_Channel", "Auto");}else {jslSetValue("Frm_Channel","Channel");}jslSetValue("Frm_BandWidth","BandWidth");jslSetValue("Frm_SideBand","SideBand");if(getValue("SGIEnabled") == "1"){setChecked("Frm_SGIEnabled", true);}else {setChecked("Frm_SGIEnabled", false);}jslSetValue("Frm_BeaconInterval","BeaconInterval");if(getValue("TxPower") == ""){setValue("Frm_TxPower", "100%");}else {jslSetValue("Frm_TxPower","TxPower");}if(getValue("QosType") == ""){setValue("Frm_QosType", "Disabled");}else {jslSetValue("Frm_QosType","QosType");}jslSetValue("Frm_RtsCts","RtsCts");jslSetValue("Frm_DTIM","DTIM");jslSetValue("Frm_Fragment","Fragment");}function disableParams(){jslDisable("Frm_DataRates","Frm_CountryCode","Frm_Channel","Frm_BandWidth");jslDisable("Frm_SideBand","Frm_SGIEnabled","Frm_BeaconInterval","Frm_TxPower");jslDisable("Frm_QosType","Frm_RtsCts","Frm_DTIM","Frm_Fragment", "Frm_SSIDIsolationEnable");}function enableParams(){jslEnable("Frm_DataRates","Frm_CountryCode","Frm_Channel","Frm_BandWidth");jslEnable("Frm_SideBand","Frm_SGIEnabled","Frm_BeaconInterval","Frm_TxPower");jslEnable("Frm_QosType","Frm_RtsCts","Frm_DTIM","Frm_Fragment", "Frm_SSIDIsolationEnable");}function Wireless_switch(){var rfMode = getValue("Frm_RFMODE");var rf = getValue("RealRF");SubParaGetValue();PageUpdate();if( rfMode=="Disabled"|| (rfMode=="Scheduled"&& rf=="0")){disableParams();}else if ( rfMode=="Enabled"|| (rfMode=="Scheduled"&& rf=="1")){enableParams();}else {}}function BeaconIntervalCheck(){var check;check = checkIntegerRange(getValue("Frm_BeaconInterval"), 100, 1000);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_BeaconInterval","Fnt_BeaconInterval",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_BeaconInterval","Fnt_BeaconInterval",msg);return false;}if (check == -3){msg = getmsg(116,100,1000);ShowErrorForCom("Frm_BeaconInterval","Fnt_BeaconInterval",msg);return false;}return true;}function RtsCtsCheck(){var check;check = checkIntegerRange(getValue("Frm_RtsCts"), 0, 2347);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_RtsCts","Fnt_RtsCts",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_RtsCts","Fnt_RtsCts",msg);return false;}if (check == -3){msg = getmsg(116,0,2347);ShowErrorForCom("Frm_RtsCts","Fnt_RtsCts",msg);return false;}return true;}function DTIMCheck(){var check;check = checkIntegerRange(getValue("Frm_DTIM"), 1, 5);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_DTIM","Fnt_DTIM",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_DTIM","Fnt_DTIM",msg);return false;}if (check == -3){msg = getmsg(116,1,5);ShowErrorForCom("Frm_DTIM","Fnt_DTIM",msg);return false;}return true;}function FragmentCheck(){var check;check = checkIntegerRange(getValue("Frm_Fragment"), 256, 2346);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_Fragment","Fnt_Fragment",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_Fragment","Fnt_Fragment",msg);return false;}if (check == -3){msg = getmsg(116,256,2346);ShowErrorForCom("Frm_Fragment","Fnt_Fragment",msg);return false;}return true;}function AllCheck(){if (BeaconIntervalCheck() == false)return false;if (RtsCtsCheck() == false)return false;if (DTIMCheck() == false)return false;if (FragmentCheck() == false)return false;return true;}function pageLoad(url){moveErrLayer(580,95);getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");if (errstr != "SUCC"&& errpara != "SUCC"){if((errpara == "BasicDataRates") || (errpara == "OpDataRates")){errpara = "DataRates";}if((errpara == "Channel") || (errpara == "AutoChannelEnabled")){errpara = "Channel";}}ProcessRet(errstr, errpara);pageGetValue();}function pageGetValue(){var RadioStatus = getValue("RadioStatus");var TimerEnable = getValue("TimerEnable");if ( TimerEnable == "1"){setValue("Frm_RFMODE", "Scheduled");}else if ( TimerEnable == "0"){if( RadioStatus == "1"){setValue("Frm_RFMODE", "Enabled");}else if ( RadioStatus == "0"){setValue("Frm_RFMODE", "Disabled");}}Wireless_switch();}function pageSetValue(){HiddenParaInit(CONFIG_PARA);var rfMode = getValue("Frm_RFMODE");if(rfMode == "Enabled"){setValue("TimerEnable", "0");setValue("RadioStatus", "1");}else if (rfMode == "Disabled"){setValue("TimerEnable", "0");setValue("RadioStatus", "0");}else if (rfMode == "Scheduled"){setValue("TimerEnable", "1");setValue("RadioStatus", "NULL");}if(getChecked("Frm_SSIDIsolationEnable") == true){setValue("SSIDIsolationEnable", "1");}else {setValue("SSIDIsolationEnable", "0");}if(getValue("Frm_DataRates") == "b"){setValue("BasicDataRates", "1,2");setValue("OpDataRates", "1,2,5.5,11");setValue("11nMode", "0");}if(getValue("Frm_DataRates") == "g"){setValue("BasicDataRates", "1,2,5.5,11,6,9,12,18,24");setValue("OpDataRates", "1,2,5.5,11,6,9,12,18,24,36,48,54");setValue("11nMode", "0");}if(getValue("Frm_DataRates") == "b,g"){setValue("BasicDataRates", "1,2,5.5,11");setValue("OpDataRates", "1,2,5.5,11,6,9,12,18,24,36,48,54");setValue("11nMode", "0");}if(getValue("Frm_DataRates") == "n"){setValue("BasicDataRates", "1,2,5.5,11");setValue("OpDataRates", "1,2,5.5,11,6,9,12,18,24,36,48,54");setValue("11nMode", "1");setValue("GreenField", "1");}if(getValue("Frm_DataRates") == "g,n"){setValue("BasicDataRates", "1,2,5.5,11,6,9,12,18,24");setValue("OpDataRates", "1,2,5.5,11,6,9,12,18,24,36,48,54");setValue("11nMode", "1");setValue("GreenField", "0");}if(getValue("Frm_DataRates") == "b,g,n"){setValue("BasicDataRates", "1,2,5.5,11");setValue("OpDataRates", "1,2,5.5,11,6,9,12,18,24,36,48,54");setValue("11nMode", "1");setValue("GreenField", "0");}jslSetValue("CountryCode","Frm_CountryCode");if(getValue("Frm_Channel") == "Auto"){setValue("AutoChannelEnabled", "1");}else {jslSetValue("Channel", "Frm_Channel");setValue("AutoChannelEnabled", "0");}if ((getValue("Frm_DataRates") == "n") || (getValue("Frm_DataRates") == "g,n")|| (getValue("Frm_DataRates") == "b,g,n")){jslSetValue("BandWidth", "Frm_BandWidth");if(getChecked("Frm_SGIEnabled") == true){setValue("SGIEnabled", "1");}else {setValue("SGIEnabled", "0");}if ((getValue("Frm_BandWidth") == "40Mhz") && (getValue("Frm_Channel") != "Auto")){jslSetValue("SideBand", "Frm_SideBand");}}jslSetValue("BeaconInterval","Frm_BeaconInterval");jslSetValue("TxPower","Frm_TxPower");jslSetValue("QosType","Frm_QosType");jslSetValue("RtsCts","Frm_RtsCts");jslSetValue("DTIM","Frm_DTIM");jslSetValue("Fragment","Frm_Fragment");}function pageSubmit(){if(AllCheck() == true){ReSetValueRmZero("Frm_BeaconInterval");ReSetValueRmZero("Frm_RtsCts");ReSetValueRmZero("Frm_DTIM");ReSetValueRmZero("Frm_Fragment");jslDisable("Btn_Submit","Btn_Cancel");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_CONFIGTAG", "Y");DisableALL();getObj("fSubmit").submit();}}function pageCancel(){jslDisable("Btn_Submit","Btn_Cancel");DisableALL();getObj("fSubmit").submit();}</SCRIPT>