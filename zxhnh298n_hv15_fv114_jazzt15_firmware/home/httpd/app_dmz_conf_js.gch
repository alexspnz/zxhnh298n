<script language="javascript">var USERIF_PARA = new Array("ViewName","Enable","WANCViewName","WANCName","InternalHost","DevUniqueNum","InternalMacHost","MacEnable");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(108, "&?error_108;");str[2] = new Array(118, "&?error_118;");str[3] = new Array(119, "&?error_119;");str[4] = new Array(122, "&?error_122;");str[5] = new Array(141, "&?error_141;");str[6] = new Array(155, "&?error_155;");str[7] = new Array(156, "&?error_156;");str[8] = new Array(110, "&?error_110;");str[9] = new Array(100, "&?error_100;");return getMsgFormArray(str, arguments) }function pageLoad(url){getObj("fSubmit").action = url;moveErrLayer(580,95);var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);pageGetValue();}function setSelOtherValue(obj, value, id){var flag = 0;var mm = getValue("WANCViewName");if ((""== mm) || ("N/A"== mm) || (null == mm)){var num = obj.length;for (var i = num ;i > 0 ;i-- ){var name = obj.options[i-1].value;var text = obj.options[i-1].text;obj.options[i] = new Option(text, text);obj.options[i].value = name;}obj.options[0] = new Option(value,value);obj.options[0].value = value;flag = 1;}return flag;}function pageGetValue(){var tem = getValue("Enable");var obj = getObj("Frm_WanName");jslPostToViewCheckBox("Frm_MacEnable", "MacEnable");changeAddressType();macmodvalue();var LanValue = getValue("InternalHost");if (tem == 1)getObj("Frm_Enable").checked = true;else getObj("Frm_Enable").checked = false;setSelOtherValue(obj, "", "Frm_WanName");jslDoShowComboBox("Frm_WanName","WANCViewName");if ("0.0.0.0"== LanValue)setValue("Frm_InternalHost", "");else setValue("Frm_InternalHost", LanValue);}function pageSetValue(){HiddenParaInit(USERIF_PARA);if (getObj("Frm_Enable").checked == true)setValue("Enable",1);else setValue("Enable",0);var obj = getObj("Frm_WanName");setValue("WANCName", obj.options[obj.selectedIndex].text);jslSetValue("WANCViewName", "Frm_WanName");jslViewToPostCheckBox("MacEnable", "Frm_MacEnable");if(getObj("Frm_MacEnable").checked == true){var macValue = MacSetValue();setValue("InternalMacHost", macValue);}else {jslSetValue("InternalHost", "Frm_InternalHost");}}function checkIPZero(value){var ipaddr = value;var parts = ipaddr.split(".");for( var i = 0; i < 4; i++){if( parseInt((parts[i]),10) != 0 )return true;}return false;}function pageCheckValue(){var msg = "";if(checkNull(getValue("Frm_WanName")) == false){msg = getmsg(100);ShowErrorForCom("Frm_WanName","Fnt_WanName",msg);return false;}if(getObj("Frm_MacEnable").checked == true){var macValue = MacSetValue();if(checkMACAddress(macValue) != true){msg = getmsg(110);ShowErrorForCom("mac1","Fnt_InternalMacHost",msg);return false;}if ( macValue.toLowerCase() == "ff:ff:ff:ff:ff:ff"){msg = getmsg(110);ShowErrorForCom("mac1","Fnt_InternalMacHost",msg);return false;}if ( macValue == "00:00:00:00:00:00"){msg = getmsg(110);ShowErrorForCom("mac1","Fnt_InternalMacHost",msg);return false;}}else {if(checkNull(getValue("Frm_InternalHost")) == false){msg = getmsg(101);ShowErrorForCom("Frm_InternalHost","Fnt_InternalHost",msg);return false;}if(checkIpAddress(getValue("Frm_InternalHost")) == false){msg = getmsg(108);ShowErrorForCom("Frm_InternalHost","Fnt_InternalHost",msg);return false;}if( false == checkIPZero( getValue("Frm_InternalHost") ) ){msg = getmsg(141);ShowErrorForCom( "Frm_InternalHost", "Fnt_InternalHost", msg);return false;}if( "127.0.0.1"== getValue("Frm_InternalHost") ){msg = getmsg(155);ShowErrorForCom( "Frm_InternalHost", "Fnt_InternalHost", msg);return false;}if( "255.255.255.255"== getValue("Frm_InternalHost") ){msg = getmsg(156);ShowErrorForCom( "Frm_InternalHost", "Fnt_InternalHost", msg);return false;}}return true;}function pageSubmit(){ReSetIpRmZero("Frm_InternalHost");if(pageCheckValue() == true){jslDisable("Btn_Submit","Btn_Cancel");pageSetValue();setValue("IF_ACTION", "apply");DisableALL();getObj("fSubmit").submit();}else {}}function pageCancel(){jslDisable("Btn_Submit","Btn_Cancel");DisableALL();getObj("fSubmit").submit();}function changeAddressType(){if(getObj("Frm_MacEnable").checked == true){jslDiDisplay("TR_InternalHost");jslEnDisplay("TR_InternalMacHost");}else {jslDiDisplay("TR_InternalMacHost");jslEnDisplay("TR_InternalHost");}}function macmodvalue(){var value_source = getValue("InternalMacHost");if("00:00:00:00:00:00"== value_source){value_source = "";}if((value_source!=":::::")&&(value_source!="")){setValue("mac1",value_source.substring(0,2));setValue("mac2",value_source.substring(3,5));setValue("mac3",value_source.substring(6,8));setValue("mac4",value_source.substring(9,11));setValue("mac5",value_source.substring(12,14));setValue("mac6",value_source.substring(15,17));}else {setValue("mac1","");setValue("mac2","");setValue("mac3","");setValue("mac4","");setValue("mac5","");setValue("mac6","");}}function MacSetValue(){var value = getValue("mac1");value += ":"+ getValue("mac2");value += ":"+ getValue("mac3");value += ":"+ getValue("mac4");value += ":"+ getValue("mac5");value += ":"+ getValue("mac6");if( ":::::"== value){value = "";}return value;}function toNext(){}</script>