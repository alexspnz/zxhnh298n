<script language="javascript">var CONFIG_PARA = new Array("Enable","RadioStatus","Standard","BeaconInterval","RtsCts","Fragment","DTIM","TxPower","CountryCode","TxRate","Channel","ESSID","ESSIDPrefix","ACLPolicy","BeaconType","WEPAuthMode","WEPEncryptionLevel","WEPKeyIndex","WPAAuthMode","WPAEncryptType","WPAGroupRekey","WPAEAPServerIp","RadiusPort","RadiusServerPort","WPAEAPSecret","PossibleChannels","BasicDataRates","OpDataRates","PossibleTxRates","OOBAccessEnabled","BeaconEnabled","ESSIDHideEnable","RegulatoryDomain","WlanMode","DistanceFromRoot","PeerBSSID","AuthServiceMode","QosType","Priority","UAPSDEnabled","AutoChannelEnabled","ChannelsInUse","11iAuthMode","11iEncryptType","MaxUserNum","SSIDIsolationEnable","VapIsolationEnable");var b_rate = new Array("1","2","5.5","11");var g_bg_rate = new Array("1","2","5.5","11","6","9","12","18","24","36","48","54");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(102, "&?error_102;");str[2] = new Array(103, "&?error_103;");str[3] = new Array(113, "&?error_113;");str[4] = new Array(115, "&?error_115;");str[5] = new Array(116, "&?error_116;");str[6] = new Array(117, "&?error_117;");str[7] = new Array(118, "&?error_118;");str[8] = new Array(119, "&?error_119;");str[9] = new Array(122, "&?error_122;");return getMsgFormArray(str, arguments);}function Mode_switch(){if(getValue("Frm_CountryCode") == "brI"){setValue("Frm_DataRates", "b");}var datarates=getValue("Frm_DataRates");var rateobj=getObj("Frm_TxRate");var i;rateobj.options[0] = new Option("&?wan022;","Auto");if(datarates == "b"){rateobj.length = b_rate.length+1;for(i=0; i<b_rate.length; i++){rateobj.options[i+1] = new Option(b_rate[i]+"Mbps",b_rate[i]);}}if((datarates == "g")||(datarates == "b,g")){rateobj.length = g_bg_rate.length+1;for(var i=0; i<g_bg_rate.length; i++){rateobj.options[i+1] = new Option(g_bg_rate[i]+"Mbps",g_bg_rate[i]);}}}function UpdateMode(){var datarates=getValue("Frm_DataRates");var rateobj=getObj("Frm_TxRate");var i;rateobj.options[0] = new Option("&?wan022;","Auto");if(datarates == "b"){rateobj.length = b_rate.length+1;for(i=0; i<b_rate.length; i++){rateobj.options[i+1] = new Option(b_rate[i]+"Mbps",b_rate[i]);}jslSetValue("Frm_TxRate","TxRate");}if((datarates == "g")||(datarates == "b,g")){rateobj.length = g_bg_rate.length+1;for(var i=0; i<g_bg_rate.length; i++){rateobj.options[i+1] = new Option(g_bg_rate[i]+"Mbps",g_bg_rate[i]);}jslSetValue("Frm_TxRate","TxRate");}if(getValue("Frm_TxRate") == ""){setValue("Frm_TxRate", "Auto");}}function SubParaGetValue(){if(getValue("SSIDIsolationEnable") == "1"){setChecked("Frm_SSIDIsolationEnable", true);}else {setChecked("Frm_SSIDIsolationEnable", false);}if((getValue("BasicDataRates") == "1,2") && (getValue("OpDataRates") == "1,2,5.5,11")){setValue("Frm_DataRates", "b");}if((getValue("BasicDataRates") == "1,2,5.5,11,6,9,12,18,24")&& (getValue("OpDataRates") == "1,2,5.5,11,6,9,12,18,24,36,48,54")){setValue("Frm_DataRates", "g");}if((getValue("BasicDataRates") == "1,2,5.5,11")&& (getValue("OpDataRates") == "1,2,5.5,11,6,9,12,18,24,36,48,54")){setValue("Frm_DataRates", "b,g");}if(getValue("Frm_DataRates") == ""){setValue("Frm_DataRates", "b");}if(getValue("CountryCode") == ""){setValue("Frm_CountryCode", "cnI");}else {jslSetValue("Frm_CountryCode","CountryCode");}jslSetValue("Frm_BeaconInterval","BeaconInterval");if(getValue("TxPower") == ""){setValue("Frm_TxPower", "100%");}else {jslSetValue("Frm_TxPower","TxPower");}if(getValue("QosType") == ""){setValue("Frm_QosType", "Disabled");}else {jslSetValue("Frm_QosType","QosType");}jslSetValue("Frm_RtsCts","RtsCts");jslSetValue("Frm_DTIM","DTIM");jslSetValue("Frm_Fragment","Fragment");}function Country_switch(){var country=getValue("Frm_CountryCode");var userClass;var channel_list;if(country == "caI"|| country == "usI"){channel_list = "1,2,3,4,5,6,7,8,9,10,11";}else {channel_list = "1,2,3,4,5,6,7,8,9,10,11,12,13";}var parts = channel_list.split(",");userClass = new Array;for (var i = 0; i < parts.length; i++){userClass[i] = parts[i];}var rateobj=getObj("Frm_Channel");rateobj.length = parts.length+1;rateobj.options[0] = new Option("&?wan022;","Auto");for(var i=0; i<parts.length; i++){rateobj.options[i+1] = new Option(userClass[i],userClass[i]);}if((getValue("AutoChannelEnabled") == "1") || (getValue("Channel") == "") || (getValue("Channel") == "0")){setValue("Frm_Channel", "Auto");}else {jslSetValue("Frm_Channel","Channel");}if(getValue("Frm_Channel") == ""){setValue("Frm_Channel", "Auto");}var temp_mode;temp_mode = getValue("Frm_DataRates");if(country == "brI"){setValue("Frm_DataRates", "b");UpdateMode();}else {setValue("Frm_DataRates", temp_mode);UpdateMode();}}function disableParams(){jslDisable("Frm_DataRates","Frm_SSIDIsolationEnable","Frm_CountryCode","Frm_Channel","Frm_BeaconInterval","Frm_TxRate","Frm_TxPower","Frm_QosType","Frm_RtsCts","Frm_DTIM","Frm_Fragment");}function enableParams(){jslEnable("Frm_DataRates","Frm_SSIDIsolationEnable","Frm_CountryCode","Frm_Channel","Frm_BeaconInterval","Frm_TxRate","Frm_TxPower","Frm_QosType","Frm_RtsCts","Frm_DTIM","Frm_Fragment");}function Wireless_switch(){var rfMode = getValue("Frm_RFMODE");var rf = getValue("RealRF");SubParaGetValue();Country_switch();if( rfMode=="Disabled"){disableParams();}else if ( rfMode=="Enabled"){enableParams();}else {}}function BeaconIntervalCheck(){var check;check = checkIntegerRange(getValue("Frm_BeaconInterval"), 20, 1000);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_BeaconInterval","Fnt_BeaconInterval",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_BeaconInterval","Fnt_BeaconInterval",msg);return false;}if (check == -3){msg = getmsg(116,20,1000);ShowErrorForCom("Frm_BeaconInterval","Fnt_BeaconInterval",msg);return false;}return true;}function RtsCtsCheck(){var check;check = checkIntegerRange(getValue("Frm_RtsCts"), 0, 2347);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_RtsCts","Fnt_RtsCts",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_RtsCts","Fnt_RtsCts",msg);return false;}if (check == -3){msg = getmsg(116,0,2347);ShowErrorForCom("Frm_RtsCts","Fnt_RtsCts",msg);return false;}return true;}function DTIMCheck(){var check;check = checkIntegerRange(getValue("Frm_DTIM"), 1, 5);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_DTIM","Fnt_DTIM",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_DTIM","Fnt_DTIM",msg);return false;}if (check == -3){msg = getmsg(116,1,5);ShowErrorForCom("Frm_DTIM","Fnt_DTIM",msg);return false;}return true;}function FragmentCheck(){var check;check = checkIntegerRange(getValue("Frm_Fragment"), 256, 2346);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_Fragment","Fnt_Fragment",msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_Fragment","Fnt_Fragment",msg);return false;}if (check == -3){msg = getmsg(116,256,2346);ShowErrorForCom("Frm_Fragment","Fnt_Fragment",msg);return false;}return true;}function AllCheck(){if (BeaconIntervalCheck() == false)return false;if (RtsCtsCheck() == false)return false;if (DTIMCheck() == false)return false;if (FragmentCheck() == false)return false;return true;}function pageLoad(url){moveErrLayer(580,95);getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");if (errstr != "SUCC"&& errpara != "SUCC"){if((errpara == "BasicDataRates") || (errpara == "OpDataRates")){errpara = "DataRates";}if((errpara == "Channel") || (errpara == "AutoChannelEnabled")){errpara = "Channel";}}ProcessRet(errstr, errpara);pageGetValue();}function pageGetValue(){var RadioStatus = getValue("RadioStatus");if( RadioStatus == "1"){setValue("Frm_RFMODE", "Enabled");}else if ( RadioStatus == "0"){setValue("Frm_RFMODE", "Disabled");}Wireless_switch();}function pageSetValue(){HiddenParaInit(CONFIG_PARA);var rfMode = getValue("Frm_RFMODE");if(rfMode == "Enabled"){setValue("RadioStatus", "1");}else if (rfMode == "Disabled"){setValue("RadioStatus", "0");}if(getChecked("Frm_SSIDIsolationEnable") == true){setValue("SSIDIsolationEnable", "1");}else {setValue("SSIDIsolationEnable", "0");}if(getValue("Frm_DataRates") == "b"){setValue("BasicDataRates", "1,2");setValue("OpDataRates", "1,2,5.5,11");}if(getValue("Frm_DataRates") == "g"){setValue("BasicDataRates", "1,2,5.5,11,6,9,12,18,24");setValue("OpDataRates", "1,2,5.5,11,6,9,12,18,24,36,48,54");}if(getValue("Frm_DataRates") == "b,g"){setValue("BasicDataRates", "1,2,5.5,11");setValue("OpDataRates", "1,2,5.5,11,6,9,12,18,24,36,48,54");}jslSetValue("CountryCode","Frm_CountryCode");if(getValue("Frm_Channel") == "Auto"){setValue("AutoChannelEnabled", "1");}else {jslSetValue("Channel", "Frm_Channel");setValue("AutoChannelEnabled", "0");}jslSetValue("BeaconInterval","Frm_BeaconInterval");jslSetValue("TxRate","Frm_TxRate");jslSetValue("TxPower","Frm_TxPower");jslSetValue("QosType","Frm_QosType");jslSetValue("RtsCts","Frm_RtsCts");jslSetValue("DTIM","Frm_DTIM");jslSetValue("Fragment","Frm_Fragment");}function pageSubmit(){if(AllCheck() == true){ReSetValueRmZero("Frm_BeaconInterval");ReSetValueRmZero("Frm_RtsCts");ReSetValueRmZero("Frm_DTIM");ReSetValueRmZero("Frm_Fragment");jslDisable("Btn_Submit","Btn_Cancel");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_CONFIGTAG", "Y");DisableALL();getObj("fSubmit").submit();}}function pageCancel(){jslDisable("Btn_Submit","Btn_Cancel");DisableALL();getObj("fSubmit").submit();}</SCRIPT>