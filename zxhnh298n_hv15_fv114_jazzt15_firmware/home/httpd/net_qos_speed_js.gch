<script language="javascript"><%var POLICE_INDEX = request("police");if( (POLICE_INDEX IS NULL) || (POLICE_INDEX == "") ){POLICE_INDEX = "-1";}%>var QOSP_PARA = new Array("ViewName","PolicerNum","Enable","Status","Dev","Rate");var QOSPOLICERNUM_PARA = new Array("PolicerNum");var index ="";function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(115, "&?error_115;");str[2] = new Array(116, "&?error_116;");str[3] = new Array(117, "&?error_117;");str[4] = new Array(118, "&?error_118;");str[5] = new Array(119, "&?error_119;");str[6] = new Array(122, "&?error_122;");str[7] = new Array(127, "&?error_127;");str[8] = new Array(183, "&?error_183;");str[9] = new Array(100, "&?error_100;");return getMsgFormArray(str, arguments);}function RateCheck(){var check;check = checkIntegerRange(getValue("Frm_Rate"), 0, 1000000000);if (check == -1){msg = getmsg(101);ShowErrorForCom("Frm_Rate", "Fnt_Rate", msg);return false;}if (check == -2){msg = getmsg(115);ShowErrorForCom("Frm_Rate", "Fnt_Rate", msg);return false;}if (check == -3){msg = getmsg(116, 0, 1000000000);ShowErrorForCom("Frm_Rate", "Fnt_Rate", msg);return false;}return true;}function deleteWDSOptions(selectID){var wdsIFArr = new Array();var ifObj = getObj(selectID);var j = 0;for ( var i=0; i<ifObj.options.length; i++ ){var optVal = ifObj.options[i].value;if ( optVal.match(/wds/i) != null ){wdsIFArr[j++] = optVal;}}for ( i=0; i<wdsIFArr.length; i++ ){deleteSelectOption(selectID, wdsIFArr[i]);}}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);deleteWDSOptions("Frm_Dev");showTable();var police_index = "";police_index = <%=POLICE_INDEX;%>;if( police_index >=0 ){Modify(police_index);}}function getImage(src, strmethod,id){return ("<input type=\"button\" id=\""+id+"\"  onclick=\""+ strmethod +"\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("+src+");\">");}function addline(index){var newline = getObj("Speed_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");for(var i = 0; i < QOSPOLICERNUM_PARA.length ; i++){newline.insertCell(-1).innerHTML = getValue(QOSPOLICERNUM_PARA[i]+index);}var qstatus = getValue("Status"+index);if ( "Disabled"== qstatus ){qstatus = "&?Disabled;";}else if ( "Enabled"== qstatus ){qstatus = "&?wan049;";}else if ( "Error"== qstatus ){qstatus = "&?Error;";}else if ( "No Interface"== qstatus ){qstatus = "&?qos_qp004;";}else {}newline.insertCell(-1).innerHTML = qstatus;newline.insertCell(-1).innerHTML=getImage("img/button_modify.gif", "Modify("+index+")","Btn_Modify"+index);newline.insertCell(-1).innerHTML=getImage("img/button_delete.gif", "Delete("+index+")","Btn_Delete"+index);}function showTable(){var num = getValue("IF_INSTNUM");if(num != 0 ){for(var i = 0; i < num; i++){addline(i);}}else {var newline = getObj("Speed_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);objcell.colSpan = 4;objcell.innerHTML= "&?note_007;"}}function pageSetValue(){HiddenParaInit(QOSP_PARA);jslSetValue("Dev", "Frm_Dev");jslViewToPostCheckBox("Enable", "Frm_Enable");jslSetValue("Rate", "Frm_Rate");}function pageCheckValue(){var msg = "";if (document.getElementById("add").style.display == ""){var num = getValue("IF_INSTNUM");if (num > 9){msg = getmsg(127);ShowErrorForCom(null, null, msg);return false;}}if ( ""== getValue("Frm_Dev") ){msg = getmsg(100);ShowErrorForCom("Frm_Dev", "Fnt_Dev", msg);return false;}if (RateCheck() == false)return false;return true;}function Add(){var number = getValue("IF_INSTNUM");document.getElementById("add").style.display="";document.getElementById("modify").style.display="none";ReSetValueRmZero("Frm_Rate");if(pageCheckValue() == true){for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}jslDisable("add","modify");pageSetValue();setValue("IF_ACTION", "new");setValue("IF_INDEX", "-1");DisableALL();getObj("fSubmit").submit();}else {}}function setSelOtherValue(obj, value, id){var flag = 0;var mm = "";if(id == null){mm = "";}else {mm = getValue(id);}if ((""== mm) || ("N/A"== mm) || (null == mm)){var num = obj.length;for (var i = num ;i > 0 ;i-- ){var name = obj.options[i-1].value;var text = obj.options[i-1].text;obj.options[i] = new Option(text, text);obj.options[i].value = name;}obj.options[0] = new Option(value,value);obj.options[0].value = value;obj.options[0].text = value;flag = 1;}return flag;}function ModifyGetValue(i){var incObj = getObj("Frm_Dev");jslDoShowComboBox("Frm_Dev", "Dev"+i);if(-1 == incObj.selectedIndex){if ( 1 == isValInSelect("", "Frm_Dev") ){setValue("Frm_Dev", "");}else {setSelOtherValue(incObj, "", null);incObj.selectedIndex = 0;}}jslPostToViewCheckBox("Frm_Enable", "Enable"+i);jslSetValue("Frm_Rate", "Rate"+i);}function Modify(i){document.getElementById("add").style.display="none";document.getElementById("modify").style.display="";document.getElementById("back").style.display="";ModifyGetValue(i);index=i;}function ModifySubmit(){var number = getValue("IF_INSTNUM");ReSetValueRmZero("Frm_Rate");if(pageCheckValue() == true){for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}jslDisable("add","modify", "back");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_INDEX",index);DisableALL();getObj("fSubmit").submit();}else {}}function Delete(i){var number = getValue("IF_INSTNUM");jslDisable("add","modify", "back");setValue("IF_ACTION", "delete");setValue("IF_INDEX",i);for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}DisableALL();getObj("fSubmit").submit();}function back4add(){var number = getValue("IF_INSTNUM");jslDisable("add","modify", "back");for(var i = 0; i < number; i++){jslDisable("Btn_Modify"+ i);jslDisable("Btn_Delete"+ i);}DisableALL();getObj("fSubmit").submit();}</script>