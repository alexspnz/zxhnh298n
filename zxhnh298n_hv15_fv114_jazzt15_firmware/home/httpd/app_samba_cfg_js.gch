<script language="javascript">var SAMBA_PARA = new Array("PassWord","NetbiosName","WorkGroup","MaxConn","GuestOk","EnableSmb","AutoRun");function getmsg(id){var str = new Array();str[0] = new Array(106, "&?error_106;");str[1] = new Array(102, "&?error_102;");str[2] = new Array(103, "&?error_103;");str[3] = new Array(118, "&?error_118;");str[4] = new Array(122, "&?error_122;");return getMsgFormArray(str, arguments); }function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");ProcessRet(errstr, errpara);moveErrLayer(595,93);pageGetValue();}function pageGetValue(){if( 1 == getValue("AutoRun")){setChecked("Frm_AutoRun",true);}else {setChecked("Frm_AutoRun",false);}if( 1 == getValue("EnableSmb")){setChecked("Frm_EnableSmb",true);}else {setChecked("Frm_EnableSmb",false);}jslSetValue("Frm_NetbiosName","NetbiosName");}function PageAutoRun(){var AutoRun = getChecked("Frm_AutoRun");if(1 == AutoRun){setChecked("Frm_EnableSmb",false);}}function PageEnableSmb(){var EnableSmb = getChecked("Frm_EnableSmb");if(1 == EnableSmb){setChecked("Frm_AutoRun",false);}}function checkSambaHostName(HostName){var len = HostName.length;var firstChar = HostName.substr(0,1);var lastChar = HostName.substr(len-1,1);var leftChar = "";var rightChar = "";var iDotCount = 0;var i = 0;var preDotPos = 0;var statu = checkStrLengthRange(HostName, 1, 15);if(statu != true){return statu;}if (HostName.match("[^0-9a-zA-Z.-]") != null){return false;}if(firstChar.match("[^0-9a-zA-Z]") != null){return false;}if(lastChar.match("[^0-9a-zA-Z]") != null){return false;}var pos = HostName.lastIndexOf(".");if(pos == -1) {var str = HostName;var len = HostName.length;for(var i=0;i<len;i++){var value = str.substring(i,i+1);if(isNaN(parseInt(value))){return true;}}return false;}else {var str = HostName.substr(pos+1);var len = HostName.length - (pos + 1);for(var i=0;i<len;i++){var value = str.substring(i,i+1);if(isNaN(parseInt(value))){return true;}}return false;}return true;}function pageCheckValue(){var NetbiosName = getValue("Frm_NetbiosName");if(checkSambaHostName(NetbiosName)!=true){var msg = "";msg = getmsg(106);ShowErrorForCom("Frm_NetbiosName","Fnt_NetbiosName",msg);return false;}return true;}function pageSetValue(){HiddenParaInit(SAMBA_PARA);if( true == getChecked("Frm_EnableSmb")){setValue("EnableSmb","1");}else {setValue("EnableSmb","0");}if( true == getChecked("Frm_AutoRun")){setValue("AutoRun","1");}else {setValue("AutoRun","0");}jslSetValue("NetbiosName","Frm_NetbiosName");}function pageCancel(){jslDisable("Btn_Submit","Btn_Cancel");DisableALL();getObj("fSubmit").submit();}function pageSubmit(){if(pageCheckValue()==true){jslDisable("Btn_Submit","Btn_Cancel");pageSetValue();setValue("IF_ACTION", "apply");DisableALL();getObj("fSubmit").submit();}}</script>