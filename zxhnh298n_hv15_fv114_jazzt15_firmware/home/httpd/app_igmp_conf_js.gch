<script language="javascript">var WAN_PARA = new Array("WanCID","WanType");var USERIF_PARA = new Array("WanType","WanCID");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(118, "&?error_118;");str[2] = new Array(119, "&?error_119;");str[3] = new Array(122, "&?error_122;");str[4] = new Array(100, "&?error_100;");return getMsgFormArray(str, arguments) }function getWANName(wanid){var o = getObj("Frm_WanName_hidden");var l = o.options.length;for (var i=0; i<l; i++){var v = o.options[i].value;var f = 0;var n = getValue("IF_INSTNUM");for (var j=0; j<n; j++){if (v == wanid){return o.options[i].text;}}}return "";}function getImage(src, strmethod,Btn_id){return ("<input type=\"button\" id=\""+Btn_id+"\"  onclick=\""+ strmethod +"\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("+src+");\">");}function addline(index){var newline = getObj("WAN_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");cellId = "Line_"+ index + "_"+ WAN_PARA[0] + "_"+ 0;newline.insertCell(-1).innerHTML = getNameValue(cellId, 38, getWANName(getValue("WanCID"+index)));newline.insertCell(-1).innerHTML=getImage("img/button_delete.gif", "Delete("+index+")", "Btn_Delete"+index);}function showTable(){var num = getValue("IF_INSTNUM");if(num != 0 ){for(var i = 0; i < num; i++){addline(i);}}else {var newline = getObj("WAN_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);objcell.colSpan = 2;objcell.innerHTML= "&?note_007;"}}function getNameValue(id, size, value){return ("<input type=\"text\" class=\"uiNoBorder\" size=\"" + size +"\" value=\""
+ value + "\"  id=\"" + id + "\"  readonly>");}function Add(){var number = getValue("IF_INSTNUM");if(pageCheckValue() == true){for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i);}jslDisable("add");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_INDEX", "-1");DisableALL();getObj("fSubmit").submit();}else {}}function Delete(i){var number = getValue("IF_INSTNUM");setValue("IF_ACTION", "delete");setValue("IF_INDEX",i);jslDisable("add");for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i);}DisableALL();getObj("fSubmit").submit();}function addOptionByValueText(id, val, txt){var f = 0;var o = getObj(id);for (var i=0; i<o.options.length; i++){var v = o.options[i].value;if (val == v){f = 1;break;}}if (f == 0){var op = document.createElement('option');op.text = txt;op.value = val;try{o.add(op,null); }catch(ex){o.add(op); }}}function dispWAN(){var o = getObj("Frm_WanName_hidden");var l = o.options.length;for (var i=0; i<l; i++){var v = o.options[i].value;var f = 0;var n = getValue("IF_INSTNUM");for (var j=0; j<n; j++){if (v == getValue("WanCID"+j)){f = 1;break;}}if (f == 0){var name = o.options[i].text;addOptionByValueText("Frm_WanName", v, name);}}}function getSelOptWANBRType(){var sov = getValue("Frm_WanName");var o = getObj("Frm_WanName_hidden");var l = o.options.length;for (var i=0; i<l; i++){var v = o.options[i].value;if (sov == v){return o.options[i].title;}}}function pageGetValue(){dispWAN();showTable();}function pageLoad(url){getObj("fSubmit").action = url;moveErrLayer(580,95);var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);pageGetValue();}function pageSetValue(){HiddenParaInit(USERIF_PARA);if (getSelOptWANBRType() == "0"){setValue("WanType", "1");}else {setValue("WanType", "2");}jslSetValue("WanCID","Frm_WanName");}function pageCheckValue(){var msg = "";if(checkNull(getValue("Frm_WanName")) == false){msg = getmsg(100);ShowErrorForCom("Frm_WanName","Fnt_WanName",msg);return false;}return true;}</script>