<script language="javascript">var PPP_PARA = new Array("WANCName","StrServList","UserName","Password");function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);moveErrLayer(590,110);pageGetValue();jslDiDisplay("Btn_Add","Btn_Delete","Btn_Cancel");jslEnDisplay("Btn_DoEdit");}function pageGetValue(){var wannameobj = getObj("Frm_WANCName1");var wan_namenum = getValue("IF_INSTNUM_PPP");if (wan_namenum != 0){for(var i=0; i< wan_namenum; i++){WANNAME = getValue("IF_WANNAME"+i);wannameobj.options[i] = new Option(WANNAME,i);}var index = getValue("IF_INDEX");if( index != -1){setValue("Frm_WANCName1",index);}var key=getValue("Frm_WANCName1");if ( key!=""){jslSetValue("Frm_UserName","UserName"+key);var pwdStr = "";if(getValue("Password"+key) == "AA=="){pwdStr = "";}else {pwdStr = getValue("Password"+key);}setValue("Frm_Password",pwdStr);}}else {DisableALL();}}function PPPoEPageAttrInfo(){var key=getValue("Frm_WANCName1");var usernameattr = getValue("IF_UsernameATTR"+key);if(usernameattr == "3"){jslDisable("Frm_UserName");}else {jslEnable("Frm_UserName");}var passwordattr = getValue("IF_PasswordATTR"+key);if(passwordattr == "3"){jslDisable("Frm_Password");}else {jslEnable("Frm_Password");}}function Change_Link(){var index=getValue("Frm_WANCName1");setValue("IF_INDEX",index);setValue("Frm_WANCName1", "");setValue("Frm_UserName", "");setValue("Frm_Password", "");jslEnable("Frm_WANCName1");DisableALL();getObj("fSubmit").submit();}function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(102, "&?error_102;");str[2] = new Array(103, "&?error_103;");str[3] = new Array(114, "&?error_114;");str[4] = new Array(124, "&?error_124;");str[5] = new Array(100, "&?error_100;");return getMsgFormArray(str, arguments);}function pageCheckValue(){if ( getValue("Frm_WANCName1") == ""){msg = getmsg(100);ShowErrorForCom("Frm_WANCName1","Fnt_WANCName1",msg);return false;}var username = getValue("Frm_UserName");if(checkGenStringForASC(username)!=true){msg = getmsg(114);ShowErrorForCom("Frm_UserName","Fnt_UserName",msg);return false;}if(Check_StrLengthRange(username,1,64,"Frm_UserName","Fnt_UserName")!=true){return false;}var pass = getValue("Frm_Password");if(checkGenStringForASC(pass)!=true){msg = getmsg(114);ShowErrorForCom("Frm_Password","Fnt_Password",msg);return false;}if(Check_StrLengthRange(pass,0,64,"Frm_Password","Fnt_Password")!=true){return false;}return true;}function pageSetValue(){var index=getValue("Frm_WANCName1");if(index==-1){index = 0;}else {index=getValue("Frm_WANCName1");}if (index !=""){setValue("IF_INDEX",index);jslSetValue("UserName"+index,"Frm_UserName");jslSetValue("Password"+index,"Frm_Password");setValue("IF_WANIDENTITY"+ index, getValue("IF_WANIDENTITY"+index));setValue("StrServList"+index,getValue("StrServList"+index));}}function pageCancel(){disableAllbutton();document.getElementById("fSubmit").submit();}function pageEdit(){if(pageCheckValue()==true){jslDisable("Btn_Add","Btn_Delete","Btn_Cancel");pageSetValue();setValue("IF_ACTION","apply");setValue("IF_MULTIDISPLAY","0");var obj=getObj("Frm_WANCName1");var name=obj.options[obj.selectedIndex].text;setValue("IF_NAME",name);DisableALL();getObj("fSubmit").submit();}}function disableAllbutton(){jslDisable("Btn_Add","Btn_Cancel", "Btn_DoEdit");}function Check_StrLengthRange(value,min,max,Frm,Fnt){if(value.length < min || value.length > max){msg = getmsg(102,min,max);ShowErrorForCom(Frm,Fnt,msg);return false;}return true;}</script>