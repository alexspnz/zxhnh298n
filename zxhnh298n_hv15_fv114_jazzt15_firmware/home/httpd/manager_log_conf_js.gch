<script language="javascript">var USERIF_PARA = new Array("LogEnable","LogLevel","ServiceIp","ServiceEnable");function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(134, "&?error_134;");str[2] = new Array(118, "&?error_118;");str[3] = new Array(119, "&?error_119;");str[4] = new Array(122, "&?error_122;");str[5] = new Array(116, "&?error_116;");str[6] = new Array(117, "&?error_117;");str[7] = new Array(102, "&?error_102;");str[8] = new Array(103, "&?error_103;");str[9] = new Array(108, "&?error_108;");str[10] = new Array(155, "&?error_155;");str[11] = new Array(156, "&?error_156;");return getMsgFormArray(str, arguments)}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);moveErrLayer(570,4);pageGetValue();jslEnable("downloadlog");}function pageGetValue(){if(getValue("IF_INDEX") == "NULL"){setValue("IF_INDEX", "0");}var logEnable = getValue("LogEnable");if(logEnable == "1"){setChecked("Frm_LogEnable", true);}else {setChecked("Frm_LogEnable", false);}setValue("Frm_LogLevel",getValue("LogLevel"));var logServiceEnable = getValue("ServiceEnable");if(logServiceEnable == "1"){setChecked("Frm_ServiceEnable", true);}else {setChecked("Frm_ServiceEnable", false);}if("0.0.0.0"==getValue("ServiceIp")){setValue("Frm_ServiceIp","");}else {setValue("Frm_ServiceIp",getValue("ServiceIp"));}LogChangeServiceEnable();}function pageSetValue(){HiddenParaInit(USERIF_PARA);if (getChecked("Frm_LogEnable") == true){setValue("LogEnable","1");}else {setValue("LogEnable","0");}jslSetValue("LogLevel","Frm_LogLevel");if (getChecked("Frm_ServiceEnable") == true){setValue("ServiceEnable","1");if(getValue("Frm_ServiceIp")==""){setValue("ServiceIp","0.0.0.0");}else {jslSetValue("ServiceIp","Frm_ServiceIp");}}else {setValue("ServiceEnable","0");}}function pageCheckValue(){if (getChecked("Frm_ServiceEnable") == true){if( false == checkIP("Frm_ServiceIp","Fnt_ServiceIp",1) ){return false;}}return true;}function pageSubmit(){ReSetIpRmZero("Frm_ServiceIp");if( pageCheckValue() == true ){jslDisable("Btn_Submit","Btn_Cancel","Btn_Refresh","Btn_Clear","Btn_download","downloadlog");pageSetValue();setValue("IF_ACTION", "apply");DisableALL();getObj("fSubmit").submit();}else {}}function pageCancel(){jslDisable("Btn_Submit","Btn_Cancel","Btn_Refresh","Btn_Clear","Btn_download");DisableALL();getObj("fSubmit").submit();}function LogChangeEnable(){if(getChecked("Frm_LogEnable") == true){jslEnable("Frm_LogLevel","Frm_ServiceEnable","Frm_LogText","Btn_Refresh","Btn_Clear","Btn_download","downloadlog");if(document.getElementById("Frm_ServiceEnable").checked == true){jslEnable("Frm_ServiceIp");}}else {jslSetValue("Frm_LogLevel", "LogLevel");var logServiceEnable = getValue("ServiceEnable");if(logServiceEnable == "1"){setChecked("Frm_ServiceEnable", true);}else {setChecked("Frm_ServiceEnable", false);}jslSetValue("Frm_ServiceIp", "ServiceIp");jslDisable("Frm_LogLevel","Frm_ServiceEnable","Frm_ServiceIp","Frm_LogText","Btn_Refresh","Btn_Clear","Btn_download","downloadlog");}}function LogRefreshSubmit(){jslDisable("Btn_Submit","Btn_Cancel","Btn_Refresh","Btn_Clear","Btn_download","downloadlog");DisableALL();getObj("fSubmit").submit();}function LogClearSubmit(){jslDisable("Btn_Submit","Btn_Cancel","Btn_Refresh","Btn_Clear","Btn_download","downloadlog");setValue("IF_ACTION", "clearlog");DisableALL();getObj("fSubmit").submit();}function myDownloadFile(){document.fDownload.submit();}function checkIP(frm_id, fnt_id, isNull, num){var msg = "";if( 0 == isNull && false == checkNull(getValue(frm_id)) ){return true;}if(false == checkNull(getValue(frm_id))){msg = getmsg(101);ShowErrorForCom(frm_id, fnt_id, msg);return false;}if(false == checkIpAddress(getValue(frm_id), num)){msg = getmsg(108);ShowErrorForCom( frm_id, fnt_id, msg);return false;}if( "127.0.0.1"== getValue(frm_id) ){msg = getmsg(155);ShowErrorForCom( frm_id, fnt_id, msg);return false;}if( "0.0.0.0"== getValue(frm_id) ){msg = getmsg(108);ShowErrorForCom( frm_id, fnt_id, msg);return false;}if( "255.255.255.255"== getValue(frm_id) ){msg = getmsg(156);ShowErrorForCom( frm_id, fnt_id, msg);return false;}return true;}function LogChangeServiceEnable(){if(document.getElementById("Frm_ServiceEnable").checked == true){jslEnable("Frm_ServiceIp");}else {if("0.0.0.0"==getValue("ServiceIp")){setValue("Frm_ServiceIp","");}else {setValue("Frm_ServiceIp",getValue("ServiceIp"));}jslDisable("Frm_ServiceIp");}}</script>