<%IMPORT FILE "common_gch.gch";var FP_MULTIDISPLAY = 1;var Sip_Line_OBJNAME = "OBJ_VOIPSIPLINE_ID";var Sip_Line_IDENTITY = "";var Sip_Line_PARANUM = 6;var Sip_Line_PARA[6] ={"AuthUserName","AuthPassword","DigestUserName","DisplayName","RegStatus","DNSStatus"};var Sip_Line_MASK_PARA[6] ={NULL,"******",NULL,NULL,NULL,NULL};var VPLine_OBJNAME = "OBJ_VOIPVPLINE_ID";var VPLine_IDENTITY = "";var VPLine_PARANUM = 2;var VPLine_PARA[2] ={"Enable","PhyList"};var FP_ACTION = request("IF_ACTION");if ("apply"!= FP_ACTION){FP_ACTION = "";}var FP_ERRORSTR = "SUCC";var FP_INDEX = getInstIndex("new");create_form_start("fSubmit", "");createSubmitHidden(FP_MULTIDISPLAY, Sip_Line_PARA, Sip_Line_PARANUM, FP_INDEX);create_hidden_newpara(VPLine_PARA, VPLine_PARANUM);if (FP_ACTION == "apply"){var FP_INSTNUM = query_list(Sip_Line_OBJNAME, "IGD");if (FP_INSTNUM > 0 && FP_INDEX >= 0){Sip_Line_IDENTITY = query_identity(FP_INDEX);FP_ERRORSTR=applyOrNewInst(Sip_Line_OBJNAME, FP_ACTION, Sip_Line_IDENTITY, Sip_Line_PARA, Sip_Line_PARANUM, FP_ERRORSTR);}var FP_INSTNUM = query_list(VPLine_OBJNAME, "IGD");if (FP_INSTNUM > 0 && FP_INDEX >= 0){VPLine_IDENTITY = query_identity(FP_INDEX);FP_ERRORSTR=applyOrNewInst(VPLine_OBJNAME, FP_ACTION, VPLine_IDENTITY, VPLine_PARA, VPLine_PARANUM, FP_ERRORSTR);}}var FP_INSTNUM = query_list(Sip_Line_OBJNAME, "IGD");for (var i = 0; i < FP_INSTNUM; i++){var FP_HANDLE = create_paralist();var FP_IDENTITY = query_identity(i);get_inst(FP_HANDLE, Sip_Line_OBJNAME, FP_IDENTITY);filter_create_hidden_multiinstpara(FP_HANDLE, Sip_Line_PARA, Sip_Line_MASK_PARA,i, Sip_Line_PARANUM);destroy_paralist(FP_HANDLE);}var FP_INSTNUM = query_list(VPLine_OBJNAME, "IGD");for (var i = 0; i < FP_INSTNUM; i++){var FP_HANDLE = create_paralist();var FP_IDENTITY = query_identity(i);get_inst(FP_HANDLE, VPLine_OBJNAME, FP_IDENTITY);create_hidden_multiinstpara(FP_HANDLE, VPLine_PARA, i, VPLine_PARANUM);destroy_paralist(FP_HANDLE);}getDisplayInstError(FP_ERRORSTR);setInstNumHidden(Sip_Line_OBJNAME, FP_MULTIDISPLAY);create_form_end();%>