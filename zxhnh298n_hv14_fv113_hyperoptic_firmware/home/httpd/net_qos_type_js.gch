<%IMPORT FILE "qos_qq_if_query.gch";%><script language="javascript">var QueueIFDevNameMap = <%qosQQIfJSON();%>;var QOST_PARA = new Array("TrafficClassCheck","TrafficClassCheckMax","TrafficClassCheckMin","FlowLabelCheck","FlowLabelCheckMax","FlowLabelCheckMin","IPv6Dest","IPv6DestPrefLen","IPv6DestMax","IPv6DestMin","IPv6Src","IPv6SrcPrefLen","IPv6SrcMax","IPv6SrcMin","Enable","DevIn","VlanPrio","MACDest","MACSrc","DSCPCheck","IPPrecedence","TOSCheck","IPDestMin","IPDestMax","IPSrcMin","IPSrcMax","L3ProtocolList","L2Protocol","SrcPortMax","SrcPortMin","DestPortMin","DestPortMax","VlanPrioMark","DscpMark","ClassQueue","PolicerQueue","Status");var QOSTYPE_PARA = new Array("ViewName");var HalfInput_PARA = new Array("Frm_IPSrc","Frm_IPDest","Frm_SrcPort","Frm_DestPort");var Tmp_ProtocolList = "";var Tmp_IPSrcMax = "";var Tmp_IPSrcMin = "";var Tmp_IPDestMin = "";var Tmp_IPDestMax = "";var Tmp_DestPortMin = "";var Tmp_DestPortMax = "";var Tmp_TOSCheck = "";var Tmp_DSCPCheck = "";var Tmp_SrcPortMin = "";var Tmp_SrcPortMax = "";var Tmp_DscpMark = "";var Tmp_IPPrecedence = "";var isPage2Tmp = 0;var index ="";var HalfInput = "";function resetTmpValue(){Tmp_ProtocolList = "";Tmp_IPSrcMax = "";Tmp_IPSrcMin = "";Tmp_IPDestMin = "";Tmp_IPDestMax = "";Tmp_DestPortMin = "";Tmp_DestPortMax = "";Tmp_TOSCheck = "";Tmp_DSCPCheck = "";Tmp_DscpMark = "";Tmp_IPPrecedence = "";Tmp_SrcPortMin = "";Tmp_SrcPortMax = "";isPage2Tmp = 0;}function showComboBox(viewid, postvalue){var i;var selector = document.getElementById(viewid);var value = postvalue;if(selector==null) return;for(i=0; i < selector.length; i++){if(selector.options[i].value == value){selector.selectedIndex = i;return;}}selector.selectedIndex = -1;}function TmpValue2Page(){if( 1 == isPage2Tmp ){showComboBox("Frm_L3ProtocolList", Tmp_ProtocolList);setValue("Frm_IPSrcMax", Tmp_IPSrcMax);setValue("Frm_IPSrcMin", Tmp_IPSrcMin);setValue("Frm_IPDestMin", Tmp_IPDestMin);setValue("Frm_IPDestMax", Tmp_IPDestMax);setValue("Frm_DestPortMin", Tmp_DestPortMin);setValue("Frm_DestPortMax", Tmp_DestPortMax);setValue("Frm_DSCPCheck", Tmp_DSCPCheck);setValue("Frm_DscpMark", Tmp_DscpMark);setValue("Frm_SrcPortMin", Tmp_DestPortMin);setValue("Frm_SrcPortMax", Tmp_DestPortMax);isPage2Tmp = 0;}}function Page2TmpValue(){if( 0 == isPage2Tmp ){Tmp_ProtocolList = getValue("Frm_L3ProtocolList");Tmp_IPSrcMax = getValue("Frm_IPSrcMax");Tmp_IPSrcMin = getValue("Frm_IPSrcMin");Tmp_IPDestMin = getValue("Frm_IPDestMin");Tmp_IPDestMax = getValue("Frm_IPDestMax");Tmp_DestPortMin = getValue("Frm_DestPortMin");Tmp_DestPortMax = getValue("Frm_DestPortMax");Tmp_DSCPCheck = getValue("Frm_DSCPCheck");Tmp_DscpMark = getValue("Frm_DscpMark");Tmp_SrcPortMin = getValue("Frm_SrcPortMin");Tmp_SrcPortMax = getValue("Frm_SrcPortMax");setValue("Frm_L3ProtocolList", "");setValue("Frm_IPSrcMax", "");setValue("Frm_IPSrcMin", "");setValue("Frm_IPDestMin", "");setValue("Frm_IPDestMax", "");setValue("Frm_DestPortMin", "");setValue("Frm_DestPortMax", "");setValue("Frm_DSCPCheck", "");setValue("Frm_DscpMark", "");isPage2Tmp = 1;}}function getmsg(id){var str = new Array();str[0] = new Array(108, "&?error_108;");str[1] = new Array(110, "&?error_110;");str[2] = new Array(115, "&?error_115;");str[3] = new Array(116, "&?error_116;");str[4] = new Array(117, "&?error_117;");str[5] = new Array(118, "&?error_118;");str[6] = new Array(119, "&?error_119;");str[7] = new Array(122, "&?error_122;");str[8] = new Array(127, "&?error_127;");str[9] = new Array(142, "&?error_142;");str[10] = new Array(149, "&?error_149;");str[11] = new Array(150, "&?error_150;");str[12] = new Array(162, "&?error_162;");str[13] = new Array(518, "&?error_518;");str[14] = new Array(519, "&?error_519;");str[15] = new Array(200, "&?error_200;");return getMsgFormArray(str, arguments)}function deleteWDSOptions(selectID){var wdsIFArr = new Array();var ifObj = getObj(selectID);var j = 0;for ( var i=0; i<ifObj.options.length; i++ ){var optVal = ifObj.options[i].value;if ( optVal.match(/wds/i) != null ){wdsIFArr[j++] = optVal;}}for ( i=0; i<wdsIFArr.length; i++ ){deleteSelectOption(selectID, wdsIFArr[i]);}}function convertQQOptions(eleId){var ele = getObj(eleId);for (var i = 0; i < ele.options.length; i++){var option = ele.options[i];if ( (option.value != -1)&& ( option.getAttribute("_Interface") !=null)&& ( option.getAttribute("_QueueNum") !=null) ){var QueueKey = option.value;var Interface = option.getAttribute("_Interface");var QueueNum = option.getAttribute("_QueueNum");var DevName = QueueIFDevNameMap[Interface];option.innerHTML = HTMLEnCode("Key"+QueueKey + "&"+ DevName + "&Prio"+ QueueNum);}}}function pageLoad(url){getObj("fSubmit").action = url;moveErrLayer(580,130);var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);deleteWDSOptions("Frm_DevInList");if (getObj("Frm_DevOutList")){deleteWDSOptions("Frm_DevOutList");}convertQQOptions("Frm_ClassQueue");showTable();linkTitle();if( getValue("IF_HALFINPUT") != ""){var innerHTML = document.getElementById("Fnt_"+getValue("IF_HALFINPUT").substr(4)).innerHTML;msg = getmsg(518, innerHTML);ShowNoteForCom(getValue("IF_HALFINPUT")+"Min", null, msg);}resetTmpValue();}function getClassValue(strmethod,value){return ("<a tip=\""+HTMLEnCode(strmethod)+"\" class=\"hand\">"+HTMLEnCode(value)+ "</a>");}function getImage(src, strmethod,id){return ("<input type=\"button\" id=\""
+ id
+ "\"  onclick=\""
+ strmethod
+ "\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("
+ src
+ ");\">");}function getSelectListValue(obj, optionValue){for (var i = 0 ;i < obj.length ;i++ ){if(obj.options[i].value == optionValue){return obj.options[i].text;}}return "";}function isIPv6Rule(index){if(getValue("IPv6SrcMin"+index) != "::"|| getValue("IPv6SrcMax"+index) != "::"|| getValue("IPv6DestMin"+index) != "::"|| getValue("IPv6DestMax"+index) != "::"|| getValue("TrafficClassCheck"+index) != "-1"|| getValue("FlowLabelCheck"+index) != "-1"|| getValue("L2Protocol"+index)=="IPV6"){return true;}return false;}function addline(index){var str ="";var classindex="";var len ="";var newline = getObj("Dhcp_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");for(var i = 0; i < QOSTYPE_PARA.length ; i++){str = getStrQosValue(index);classindex = getValue(QOSTYPE_PARA[i]+index) ;if(classindex !=""){len = classindex.length ;classindex = classindex.substr(10, len-10);}var newCell = newline.insertCell(-1);newCell.innerHTML = getClassValue(str, classindex);}var qstatus = getValue("Status"+index);if ( "Disabled"== qstatus ){qstatus = "&?Disabled;";}else if ( "Enabled"== qstatus ){qstatus = "&?wan049;";}else if ( "Error"== qstatus ){qstatus = "&?Error;";}else if ( "No Interface"== qstatus ){qstatus = "&?qos_qp004;";}else {}newline.insertCell(-1).innerHTML = qstatus;newline.insertCell(-1).innerHTML=getImage("img/button_modify.gif", "Modify("+index+")", "Btn_Modify"+index);newline.insertCell(-1).innerHTML=getImage("img/button_delete.gif", "Delete("+index+")","Btn_Delete"+index);}function showTable(){var num = getValue("IF_INSTNUM");if(num != 0){for(var i = 0; i < num; i++){addline(i);}}var multiInstTbl = getObj("Dhcp_Table");var rowsNum = multiInstTbl.rows.length;if ( rowsNum == 1 ){var newline = getObj("Dhcp_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);objcell.colSpan = 4;objcell.innerHTML= "&?note_007;"}}function getStrQosValue(index){var value ="";var MAC_Src, Vlan_Prio, IP_Src_Min, IP_Src_Max, IP_Dest_Min, IP_Dest_Max, Dest_Port_Min, Dest_Port_Max;var TOS_Check, DSCP_Check, Vlan_PrioMark, Dscp_Mark;var IPv6_Src_Min, IPv6_Src_Max, IPv6_Dest_Min, IPv6_Dest_Max, IPv6_TrafficClassCheck, IPv6_FlowLabelCheck;var Src_Port_Min,Src_Port_Max,MAC_Dest;if(getValue("L2Protocol"+index)=="IP"){setValue("L2Protocol"+index,"IPv4");}if(getValue("L2Protocol"+index)=="IPV6"){setValue("L2Protocol"+index,"IPv6");}if(getValue("L2Protocol"+index)=="PPPOE"){setValue("L2Protocol"+index,"PPPoE");}MAC_Src = getValue("MACSrc"+index);if(MAC_Src == "00:00:00:00:00:00"){MAC_Src ="";}Vlan_Prio = getValue("VlanPrio"+index);if(Vlan_Prio == "-1"){Vlan_Prio ="";}IP_Src_Min = getValue("IPSrcMin"+index);if(IP_Src_Min == "0.0.0.0"){IP_Src_Min ="";}IP_Src_Max = getValue("IPSrcMax"+index);if(IP_Src_Max == "0.0.0.0"){IP_Src_Max ="";}IP_Dest_Min = getValue("IPDestMin"+index);if(IP_Dest_Min == "0.0.0.0"){IP_Dest_Min ="";}IP_Dest_Max = getValue("IPDestMax"+index);if(IP_Dest_Max == "0.0.0.0"){IP_Dest_Max ="";}MAC_Dest = getValue("MACDest"+index);if(MAC_Dest == "00:00:00:00:00:00"){MAC_Dest ="";}Src_Port_Min = getValue("SrcPortMin"+index);if(Src_Port_Min == "-1"){Src_Port_Min ="";}Src_Port_Max = getValue("SrcPortMax"+index);if(Src_Port_Max == "-1"){Src_Port_Max ="";}Dest_Port_Min = getValue("DestPortMin"+index);if(Dest_Port_Min == "-1"){Dest_Port_Min ="";}Dest_Port_Max = getValue("DestPortMax"+index);if(Dest_Port_Max == "-1"){Dest_Port_Max ="";}DSCP_Check = getValue("DSCPCheck"+index);if(DSCP_Check == "-1"){DSCP_Check ="";}Vlan_PrioMark = getValue("VlanPrioMark"+index);if(Vlan_PrioMark == "-1"){Vlan_PrioMark ="";}Dscp_Mark = getValue("DscpMark"+index);if(Dscp_Mark == "-1"){Dscp_Mark ="";}if(getValue("PolicerQueue"+index) == "-1")setValue("PolicerQueue"+index,"");if(getValue("ClassQueue"+index) == "-1"){setValue("ClassQueue"+index,"");}else {var ele = getObj("Frm_ClassQueue");for (var i = 0; i < ele.options.length; i++){var option = ele.options[i];if ( option.value == getValue("ClassQueue"+index)){var Interface = option.getAttribute("_Interface");var QueueNum = option.getAttribute("_QueueNum");var DevName = QueueIFDevNameMap[Interface];setValue("ClassQueue"+index,HTMLEnCode("Key"+option.value + "&"+ DevName + "&Prio"+ QueueNum));i = ele.options.length;}}}value +="&?comm001;&?colon; "+getValue("Enable"+index) +"<br>";value +="&?qos_d001;&?colon; "+HTMLEnCode(getSelectListValue(getObj("Frm_DevInList"), getValue("DevIn"+index))) +"<br>";value +="&?qos_t017;&?colon; "+getValue("L2Protocol"+index)+"<br>";value +="&?qos_t018;&?colon; "+getValue("L3ProtocolList"+index)+"<br>";value +="&?qos_c002;&?colon; "+MAC_Src +"<br>";value +="&?maco017;&?colon; "+MAC_Dest +"<br>";value +="&?wan057;&?colon; "+Vlan_Prio +"<br>";value +="&?route003; MIN&?colon; "+Src_Port_Min +"<br>";value +="&?route003; MAX&?colon; "+Src_Port_Max +"<br>";value +="&?qos_c008;&?colon; "+DSCP_Check +"<br>";value +="&?qos_c004; MIN&?colon; "+IP_Src_Min +"<br>";value +="&?qos_c004; MAX&?colon; "+IP_Src_Max +"<br>";value +="&?qos_c005; MIN&?colon; "+IP_Dest_Min +"<br>";value +="&?qos_c005; MAX&?colon; "+IP_Dest_Max +"<br>";value +="&?qos_c010;&?colon; "+Vlan_PrioMark +"<br>";value +="&?qos_c011;&?colon; "+Dscp_Mark +"<br>";value +="&?qos_qp001;&?colon; "+getValue("PolicerQueue"+index) +"<br>";value +="&?qos_c012;&?colon; "+getValue("ClassQueue"+index) +"<br>";if(getValue("L2Protocol"+index)=="IPv4"){setValue("L2Protocol"+index,"IP");}if(getValue("L2Protocol"+index)=="IPv6"){setValue("L2Protocol"+index,"IPV6");}if(getValue("L2Protocol"+index)=="PPPoE"){setValue("L2Protocol"+index,"PPPOE");}var tmp =getValue("ClassQueue"+index);if(tmp!=""){var ss = tmp.split("&");setValue("ClassQueue"+index,ss[0].substr(3));}return value ;}function addEvent(elm, evType, fn, useCapture){if (elm.addEventListener){elm.addEventListener(evType, fn, useCapture);return true;}else if (elm.attachEvent){var r = elm.attachEvent("on"+evType, fn);return r;}else {}}function linkTitle(){if(!document.getElementsByTagName){return ;}var anchors=document.getElementsByTagName("a");for(var i=0;i<anchors.length;i++){anchor=anchors[i];if(anchor.getAttribute("tip")){addEvent(anchor,"mouseover",linkMouseOver);addEvent(anchor,"mouseout",linkMouseOut);}}}function linkMouseOver(ev){var ev=ev||window.event;var title=document.getElementById("tips");title.style.top=(ev.clientY||ev.pageY)+"px";title.style.left=(ev.clientX||ev.pageX)+"px";title.style.display="block";document.getElementById("content_3").innerHTML=(ev.srcElement||ev.target).getAttribute("tip");}function linkMouseOut(){document.getElementById("tips").style.display="none";}function MacGetValue(i){var src_value = getValue("MACSrc"+i);if( src_value == "00:00:00:00:00:00"){setValue("mac1", "");setValue("mac2", "");setValue("mac3", "");setValue("mac4", "");setValue("mac5", "");setValue("mac6", "");}else {var temp= src_value.split(":");setValue("mac1", temp[0]);setValue("mac2", temp[1]);setValue("mac3", temp[2]);setValue("mac4", temp[3]);setValue("mac5", temp[4]);setValue("mac6", temp[5]);}var dest_value = getValue("MACDest"+i);if( dest_value == "00:00:00:00:00:00"){setValue("mac7", "");setValue("mac8", "");setValue("mac9", "");setValue("mac10", "");setValue("mac11", "");setValue("mac12", "");}else {var temp= dest_value.split(":");setValue("mac7", temp[0]);setValue("mac8", temp[1]);setValue("mac9", temp[2]);setValue("mac10", temp[3]);setValue("mac11", temp[4]);setValue("mac12", temp[5]);}}function MacSetValue(){var value = getValue("mac1");value += ":"+ getValue("mac2");value += ":"+ getValue("mac3");value += ":"+ getValue("mac4");value += ":"+ getValue("mac5");value += ":"+ getValue("mac6");if( ":::::"== value){value = "";}return value;}function MacSetValue_des(){var value_des = getValue("mac7");value_des += ":"+ getValue("mac8");value_des += ":"+ getValue("mac9");value_des += ":"+ getValue("mac10");value_des += ":"+ getValue("mac11");value_des += ":"+ getValue("mac12");if( ":::::"== value_des){value_des = "";}return value_des;}function jslSetIPValue(destId, srcId){if(getValue(srcId) == "0.0.0.0"){setValue(destId, "");}else {jslSetValue(destId, srcId);}}function jslSetPortValue(destId, srcId){if(getValue(srcId) == "-1"){setValue(destId, "");}else {jslSetValue(destId, srcId);}}function jslSetIPv6Value(destId, srcId){if(getValue(srcId) == "::"){setValue(destId, "");}else if( (getValue(srcId) !="")&&(getValue(srcId) != null )){jslSetValue(destId, srcId);}}function ModifyGetValue(i){jslPostToViewCheckBox("Frm_Enable", "Enable"+i);jslDoShowComboBox("Frm_DevInList", "DevIn"+i);jslDoShowComboBox("Frm_L3ProtocolList", "L3ProtocolList"+i);jslDoShowComboBox("Frm_L2ProtocolList", "L2Protocol"+i);MacGetValue(i);jslSetPortValue("Frm_VLANID", "VlanID"+i);jslSetPortValue("Frm_VlanPrio", "VlanPrio"+i);jslSetIPValue("Frm_IPSrcMin", "IPSrcMin"+i);jslSetIPValue("Frm_IPSrcMax", "IPSrcMax"+i);jslSetIPValue("Frm_IPDestMin", "IPDestMin"+i);jslSetIPValue("Frm_IPDestMax", "IPDestMax"+i);jslSetPortValue("Frm_DestPortMin", "DestPortMin"+i);jslSetPortValue("Frm_DestPortMax", "DestPortMax"+i);jslSetPortValue("Frm_DSCPCheck", "DSCPCheck"+i);jslSetPortValue("Frm_VlanPrioMark", "VlanPrioMark"+i);jslSetPortValue("Frm_DscpMark", "DscpMark"+i);jslDoShowComboBox("Frm_ClassQueue_qp", "PolicerQueue"+i);jslDoShowComboBox("Frm_ClassQueue", "ClassQueue"+i);jslSetPortValue("Frm_SrcPortMin", "SrcPortMin"+i);jslSetPortValue("Frm_SrcPortMax", "SrcPortMax"+i);if(getValue("Frm_L2ProtocolList") == "ARP"){jslDisable("Frm_L3ProtocolList","Frm_IPSrcMax","Frm_IPSrcMin","Frm_IPDestMin","Frm_IPDestMax","Frm_DestPortMin","Frm_DestPortMax","Frm_DSCPCheck","Frm_DscpMark");jslDisable("Frm_SrcPortMin","Frm_SrcPortMax");}else {jslEnable("Frm_L3ProtocolList","Frm_IPSrcMax","Frm_IPSrcMin","Frm_IPDestMin","Frm_IPDestMax","Frm_DestPortMin","Frm_DestPortMax","Frm_DSCPCheck","Frm_DscpMark");jslEnable("Frm_SrcPortMin","Frm_SrcPortMax");}resetTmpValue();}function pageSetValue(){HiddenParaInit(QOST_PARA);jslViewToPostCheckBox("Enable", "Frm_Enable");jslSetValue("DevIn", "Frm_DevInList");jslSetValue("L2Protocol", "Frm_L2ProtocolList");jslSetValue("L3ProtocolList", "Frm_L3ProtocolList");var value = MacSetValue();if( value != ""){setValue("MACSrc", value);}else {setValue("MACSrc", "00:00:00:00:00:00");}var destmac = MacSetValue_des();if( destmac != ""){setValue("MACDest", destmac);}else {setValue("MACDest", "00:00:00:00:00:00");}if(getValue("Frm_VLANID")!=""){jslSetValue("VlanID", "Frm_VLANID");}else {setValue("VlanID", "-1");}if(getValue("Frm_VlanPrio")!=""){jslSetValue("VlanPrio", "Frm_VlanPrio");}else {setValue("VlanPrio", "-1");}if(getValue("Frm_IPSrcMin")!=""){jslSetValue("IPSrcMin", "Frm_IPSrcMin");}else {setValue("IPSrcMin", "0.0.0.0");}if(getValue("Frm_IPSrcMax")!=""){jslSetValue("IPSrcMax", "Frm_IPSrcMax");}else {setValue("IPSrcMax", "0.0.0.0");}if(getValue("Frm_IPDestMin")!=""){jslSetValue("IPDestMin", "Frm_IPDestMin");}else {setValue("IPDestMin", "0.0.0.0");}if(getValue("Frm_IPDestMax")!=""){jslSetValue("IPDestMax", "Frm_IPDestMax");}else {setValue("IPDestMax", "0.0.0.0");}if(getValue("Frm_DestPortMin")!=""){jslSetValue("DestPortMin", "Frm_DestPortMin");}else {setValue("DestPortMin", "-1");}if(getValue("Frm_DestPortMax")!=""){jslSetValue("DestPortMax", "Frm_DestPortMax");}else {setValue("DestPortMax", "-1");}if(getValue("Frm_SrcPortMin")!=""){jslSetValue("SrcPortMin", "Frm_SrcPortMin");}else {setValue("SrcPortMin", "-1");}if(getValue("Frm_SrcPortMax")!=""){jslSetValue("SrcPortMax", "Frm_SrcPortMax");}else {setValue("SrcPortMax", "-1");}if(getValue("Frm_DSCPCheck")!=""){jslSetValue("DSCPCheck", "Frm_DSCPCheck");}else {setValue("DSCPCheck", "-1");}if(getValue("Frm_VlanPrioMark")!=""){jslSetValue("VlanPrioMark", "Frm_VlanPrioMark");}else {setValue("VlanPrioMark", "-1");}if(getValue("Frm_DscpMark")!=""){jslSetValue("DscpMark", "Frm_DscpMark");}else {setValue("DscpMark", "-1");}if(getValue("Frm_ClassQueue")!=""){jslSetValue("ClassQueue", "Frm_ClassQueue");}if(getValue("Frm_ClassQueue_qp")!=""){jslSetValue("PolicerQueue", "Frm_ClassQueue_qp");}else {setValue("PolicerQueue", "-1");}}function compareIP(minIP, maxIP){var minParts = minIP.split(".");var maxParts = maxIP.split(".");for( var i = 0; i < 4; i++){if( parseInt((minParts[i]),10) != parseInt((maxParts[i]),10) ){return (parseInt((minParts[i]),10) - parseInt((maxParts[i]),10));}}}function Check_IP(value,Frm,Fnt){if(checkIpAddress(value,"")!=true){msg = getmsg(108);ShowErrorForCom(Frm,Fnt,msg);return false;}if(value=="0.0.0.0"){msg = getmsg(108);ShowErrorForCom(Frm,Fnt,msg);return false;}return true;}function Check_IPv6(value,Frm,Fnt){if(checkIPV6Address(value) != true ){msg = getmsg(200);ShowErrorForCom(Frm,Fnt,msg);return false;}return true;}function pageCheckValue(){var msg = "";var value = MacSetValue();var value_des = MacSetValue_des();if(value!=""){if(checkMACAddress(value) == false){msg = getmsg(110);ShowErrorForCom("mac1","Fnt_MACSrc",msg);return false;}}if(value_des!=""){if(checkMACAddress(value_des) == false){msg = getmsg(110);ShowErrorForCom("mac7","Fnt_DES_MAC",msg);return false;}}if(getValue("Frm_VLANID")!=""){var vlanid=getValue("Frm_VLANID");if(checkInteger(vlanid) == false){msg = getmsg(115);ShowErrorForCom("Frm_VLANID","Fnt_VLANID",msg);return false;}if(checkIntegerRange(vlanid,0,4094)!=true){msg = getmsg(116,0,4094);ShowErrorForCom("Frm_VLANID","Fnt_VLANID",msg);return false;}}if(getValue("Frm_VlanPrio")!=""){if(checkInteger(getValue("Frm_VlanPrio")) == false){msg = getmsg(115);ShowErrorForCom("Frm_VlanPrio","Fnt_VlanPrio",msg);return false;}var value = getValue("Frm_VlanPrio");if(checkIntegerRange(value, 0, 7) != true){msg = getmsg(116,0,7);ShowErrorForCom("Frm_VlanPrio","Fnt_VlanPrio",msg);return false;}}if(getValue("Frm_IPSrcMin")!=""){if(Check_IP(getValue("Frm_IPSrcMin"),"Frm_IPSrcMin","Fnt_IPSrc")!=true){return false;}}if(getValue("Frm_IPSrcMax")!=""){if(Check_IP(getValue("Frm_IPSrcMax"),"Frm_IPSrcMax","Fnt_IPSrc")!=true){return false;}}if (getValue("Frm_IPSrcMin")!=""&& getValue("Frm_IPSrcMax")!=""){var minIP = getValue("Frm_IPSrcMin");var maxIP = getValue("Frm_IPSrcMax");if (compareIP(minIP, maxIP) > 0){msg = getmsg(149);ShowErrorForCom("Frm_IPSrcMin", null,msg);return false;}}if(getValue("Frm_IPDestMin")!=""){if(Check_IP(getValue("Frm_IPDestMin"),"Frm_IPDestMin","Fnt_IPDest")!=true){return false;}}if(getValue("Frm_IPDestMax")!=""){if(Check_IP(getValue("Frm_IPDestMax"),"Frm_IPDestMax","Fnt_IPDest")!=true){return false;}}if (getValue("Frm_IPDestMin")!=""&& getValue("Frm_IPDestMax")!=""){var minIP = getValue("Frm_IPDestMin");var maxIP = getValue("Frm_IPDestMax");if (compareIP(minIP, maxIP) > 0){msg = getmsg(150);ShowErrorForCom("Frm_IPDestMin", null,msg);return false;}}if(getValue("Frm_SrcPortMin")!=""){if( getValue("Frm_L3ProtocolList") != "TCP"&& getValue("Frm_L3ProtocolList") != "UDP"){msg = getmsg(142);ShowErrorForCom("Frm_SrcPortMin","",msg);return false;}if(checkInteger(getValue("Frm_SrcPortMin")) == false){msg = getmsg(115);ShowErrorForCom("Frm_SrcPortMin","Fnt_SrcPort",msg);return false;}var value = getValue("Frm_SrcPortMin");if(checkIntegerRange(value, 0, 65535) != true){msg = getmsg(116,0,65535);ShowErrorForCom("Frm_SrcPortMin","Fnt_SrcPort",msg);return false;}}if(getValue("Frm_SrcPortMax")!=""){if( getValue("Frm_L3ProtocolList") != "TCP"&& getValue("Frm_L3ProtocolList") != "UDP"){msg = getmsg(142);ShowErrorForCom("Frm_SrcPortMax","",msg);return false;}if(checkInteger(getValue("Frm_SrcPortMax")) == false){msg = getmsg(115);ShowErrorForCom("Frm_SrcPortMax","Fnt_SrcPort",msg);return false;}var value = getValue("Frm_SrcPortMax");if(checkIntegerRange(value, 0, 65535) != true){msg = getmsg(116,0,65535);ShowErrorForCom("Frm_SrcPortMax","Fnt_SrcPort",msg);return false;}}if (getValue("Frm_SrcPortMin")!=""&& getValue("Frm_SrcPortMax")!=""){var minPort = parseInt(getValue("Frm_SrcPortMin"));var maxPort = parseInt(getValue("Frm_SrcPortMax"));if (minPort > maxPort){msg = getmsg(162);ShowErrorForCom("Frm_SrcPortMin", null,msg);return false;}}if(getValue("Frm_DestPortMin")!=""){if( getValue("Frm_L3ProtocolList") != "TCP"&& getValue("Frm_L3ProtocolList") != "UDP"){msg = getmsg(142);ShowErrorForCom("Frm_DestPortMin","",msg);return false;}if(checkInteger(getValue("Frm_DestPortMin")) == false){msg = getmsg(115);ShowErrorForCom("Frm_DestPortMin","Fnt_DestPort",msg);return false;}var value = getValue("Frm_DestPortMin");if(checkIntegerRange(value, 0, 65535) != true){msg = getmsg(116,0,65535);ShowErrorForCom("Frm_DestPortMin","Fnt_DestPort",msg);return false;}}if(getValue("Frm_DestPortMax")!=""){if( getValue("Frm_L3ProtocolList") != "TCP"&& getValue("Frm_L3ProtocolList") != "UDP"){msg = getmsg(142);ShowErrorForCom("Frm_DestPortMax","",msg);return false;}if(checkInteger(getValue("Frm_DestPortMax")) == false){msg = getmsg(115);ShowErrorForCom("Frm_DestPortMax","Fnt_DestPort",msg);return false;}var value = getValue("Frm_DestPortMax");if(checkIntegerRange(value, 0, 65535) != true){msg = getmsg(116,0,65535);ShowErrorForCom("Frm_DestPortMax","Fnt_DestPort",msg);return false;}}if (getValue("Frm_DestPortMin")!=""&& getValue("Frm_DestPortMax")!=""){var minPort = parseInt(getValue("Frm_DestPortMin"));var maxPort = parseInt(getValue("Frm_DestPortMax"));if (minPort > maxPort){msg = getmsg(162);ShowErrorForCom("Frm_DestPortMin", null,msg);return false;}}var k = 0;for(k = 0; k < HalfInput_PARA.length; k++){if( checkHalfInput( HalfInput_PARA[k] + "Min", HalfInput_PARA[k] + "Max") == true ){HalfInput = HalfInput_PARA[k];break;}}if(k >= HalfInput_PARA.length){HalfInput = "";}if(getValue("Frm_DSCPCheck")!=""){if(checkInteger(getValue("Frm_DSCPCheck")) == false){msg = getmsg(115);ShowErrorForCom("Frm_DSCPCheck","Fnt_DSCPCheck",msg);return false;}var value = getValue("Frm_DSCPCheck");if(checkIntegerRange(value, 0, 63) != true){msg = getmsg(116,0,63);ShowErrorForCom("Frm_DSCPCheck","Fnt_DSCPCheck",msg);return false;}}if(getValue("Frm_VlanPrioMark")!=""){if(checkInteger(getValue("Frm_VlanPrioMark")) == false){msg = getmsg(115);ShowErrorForCom("Frm_VlanPrioMark","Fnt_VlanPrioMark",msg);return false;}var value = getValue("Frm_VlanPrioMark");if(checkIntegerRange(value, 0, 7) != true){msg = getmsg(116,0,7);ShowErrorForCom("Frm_VlanPrioMark","Fnt_VlanPrioMark",msg);return false;}}if(getValue("Frm_DscpMark")!=""){if(checkInteger(getValue("Frm_DscpMark")) == false){msg = getmsg(115);ShowErrorForCom("Frm_DscpMark","Fnt_DscpMark",msg);return false;}var value = getValue("Frm_DscpMark");if(checkIntegerRange(value, 0, 63) != true){msg = getmsg(116,0,63);ShowErrorForCom("Frm_DscpMark","Fnt_DscpMark",msg);return false;}}return true;}function CheckVlanID(){if (getChecked("Frm_WBDMode")==true){var vlan=getValue("Frm_VLANID");if(Check_IntegerRange(vlan,0,4094,"Frm_VLANID","Fnt_VLANID")!=true){return false;}}}function checkHalfInput(minId, maxId){if( (getValue(minId) == "") && (getValue(maxId) == "") ){return false;}if( (getValue(minId) != "") && (getValue(maxId) != "") ){return false;}return true;}function toNext(obj){}function Add(){var number = getValue("IF_INSTNUM");document.getElementById("add").style.display="";document.getElementById("modify").style.display="none";ReSetIpRmZero("Frm_IPSrc","Frm_IPDest");ReSetValueRmZero("Frm_VLANID");ReSetValueRmZero("Frm_VlanPrio","Frm_DestPort","Frm_DSCPCheck");ReSetValueRmZero("Frm_VlanPrioMark","Frm_DscpMark");if(pageCheckValue() == true){for(var i = 0; i < number; i++){try{jslDisable("Btn_Modify"+ i);jslDisable("Btn_Delete"+ i);}catch (e){}}jslDisable("add","modify");pageSetValue();setValue("IF_HALFINPUT", HalfInput);setValue("IF_ACTION", "new");setValue("IF_INDEX", "-1");DisableALL();getObj("fSubmit").submit();}else {}}function Modify(i){document.getElementById("add").style.display="none";document.getElementById("modify").style.display="";document.getElementById("back").style.display="";ModifyGetValue(i);index=i;}function ModifySubmit(){var number = getValue("IF_INSTNUM");ReSetIpRmZero("Frm_IPSrcMin", "Frm_IPSrcMax", "Frm_IPDestMin", "Frm_IPDestMax");ReSetValueRmZero("Frm_VlanPrio","Frm_DestPortMin","Frm_DestPortMax","Frm_DSCPCheck");ReSetValueRmZero("Frm_VlanPrioMark","Frm_DscpMark");ReSetValueRmZero("Frm_VLANID","Frm_SrcPortMin","Frm_SrcPortMax");if(pageCheckValue() == true){for(var i = 0; i < number; i++){try{jslDisable("Btn_Modify"+ i);jslDisable("Btn_Delete"+ i);}catch (e){}}jslDisable("add","modify", "back");pageSetValue();setValue("ViewName", getValue("ViewName"+index));setValue("IF_HALFINPUT", HalfInput);setValue("IF_ACTION", "apply");setValue("IF_INDEX",index);DisableALL();getObj("fSubmit").submit();}else {}}function Delete(i){var number = getValue("IF_INSTNUM");jslDisable("add","modify", "back");setValue("IF_ACTION", "delete");setValue("IF_INDEX",i);setValue("IF_HALFINPUT", "");for(var i = 0; i < number; i++){try{jslDisable("Btn_Modify"+ i);jslDisable("Btn_Delete"+ i);}catch (e){}}DisableALL();getObj("fSubmit").submit();}function Change_protocol(){if(getValue("Frm_L2ProtocolList")=="ARP"){jslDisable("Frm_L3ProtocolList","Frm_IPSrcMax","Frm_IPSrcMin","Frm_IPDestMin","Frm_IPDestMax","Frm_DestPortMin","Frm_DestPortMax","Frm_DSCPCheck","Frm_DscpMark");jslDisable("Frm_SrcPortMin","Frm_SrcPortMax");Page2TmpValue();}else {jslEnable("Frm_L3ProtocolList","Frm_IPSrcMax","Frm_IPSrcMin","Frm_IPDestMin","Frm_IPDestMax","Frm_DestPortMin","Frm_DestPortMax","Frm_DSCPCheck","Frm_DscpMark");jslEnable("Frm_SrcPortMin","Frm_SrcPortMax");TmpValue2Page();}}function DisPlayipv4(){var img=getObj("Frm_ipv4").src;var tmp = img.substring(img.length-6,img.length);if ("up.gif"== tmp){getObj("Frm_ipv4").src="img/down.gif";jslDiDisplay("TR_IPSrc","TR_IPDest");}else {getObj("Frm_ipv4").src="img/up.gif";jslEnDisplay("TR_IPSrc","TR_IPDest");}}function DisPlayipv6(){var img=getObj("Frm_ipv6").src;var tmp = img.substring(img.length-6,img.length);if ("up.gif"== tmp){getObj("Frm_ipv6").src="img/down.gif";jslDiDisplay("TR_IPv6Src","TR_IPv6Dest","TR_TrafficClassCheck","TR_FlowLabelCheck");}else {getObj("Frm_ipv6").src="img/up.gif";jslEnDisplay("TR_IPv6Src","TR_IPv6Dest","TR_TrafficClassCheck","TR_FlowLabelCheck");}}function back4add(){var number = getValue("IF_INSTNUM");jslDisable("add","modify", "back");for(var i = 0; i < number; i++){try{jslDisable("Btn_Modify"+ i);jslDisable("Btn_Delete"+ i);}catch (e){}}DisableALL();getObj("fSubmit").submit();}</script>