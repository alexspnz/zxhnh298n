<%IMPORT FILE "common_gch.gch";var WDS_OBJNAME = "OBJ_WDS_ID";var WDS_PARANUM = 8;var WDS_PARA[8] ={"WDSMac1","WDSMac2","WDSMac3","WDSMac4","WDSConnectStatus1","WDSConnectStatus2","WDSConnectStatus3","WDSConnectStatus4"};var CONFIG_OBJNAME = "OBJ_WLANCONFIG_ID";var CONFIG_INSTNUM = query_list(CONFIG_OBJNAME, "IGD");var CONFIG_IDENTITY = query_identity(0);var CONFIG_DRV_OBJNAME = "OBJ_WLANCONFIGDRV_ID";var CONFIG_DRV_IDENTITY = CONFIG_IDENTITY;var Bssid = "";var RealRF = "";var CONFIG_DRV_HANDLE = create_paralist();get_inst(CONFIG_DRV_HANDLE, CONFIG_DRV_OBJNAME, CONFIG_DRV_IDENTITY);Bssid = get_para(CONFIG_DRV_HANDLE, "Bssid");RealRF = get_para(CONFIG_DRV_HANDLE, "RealRF");destroy_paralist(CONFIG_DRV_HANDLE);unsetenv("Bssid");setenv("Bssid", Bssid);unsetenv("RealRF");setenv("RealRF", RealRF);function modeSet(){var WLAN_CONFIG_PARA[2] ={"WdsMode",""};var WC_OBJNAME = "OBJ_WLANCONFIG_ID";var WC_INSTNUM = query_list(WC_OBJNAME, "IGD");var WC_PARANUM = 1;var WC_IDENTITY = query_identity(0);var WC_HANDLE = create_paralist();for(var i=0; i< WC_PARANUM; i++){setpara(WC_HANDLE, WLAN_CONFIG_PARA[i]);}WC_IDENTITY = set_inst(WC_HANDLE, WC_OBJNAME, WC_IDENTITY);}function modeGet(){var WLAN_CONFIG_PARA[2] ={"WdsMode",""};var WC_OBJNAME = "OBJ_WLANCONFIG_ID";var WC_INSTNUM = query_list(WC_OBJNAME, "IGD");var WC_IDENTITY = query_identity(0);var WC_PARANUM = 1;var WC_HANDLE;var wdsMode = "";create_hidden_newpara(WLAN_CONFIG_PARA, WC_PARANUM);WC_HANDLE = create_paralist();get_inst(WC_HANDLE, WC_OBJNAME, WC_IDENTITY);wdsMode = get_para(WC_HANDLE, "WdsMode"); unsetenv("wdsMode");setenv("wdsMode", wdsMode);cover_hidden(WC_HANDLE, WLAN_CONFIG_PARA, WC_PARANUM);destroy_paralist(WC_HANDLE);}function WDSInstSet(){var WDS_IDENTITY = "";var WDS_HANDLE = create_paralist();query_list("OBJ_WLANSETTING_ID", "IGD");query_list("OBJ_WDS_ID", query_identity(0));WDS_IDENTITY = query_identity(0);for (var j=0; j<WDS_PARANUM; j++){setpara(WDS_HANDLE, WDS_PARA[j]);}WDS_IDENTITY = set_inst(WDS_HANDLE, WDS_OBJNAME, WDS_IDENTITY);}function WDSInstGet(){var WDS_IDENTITY = "";var WDS_HANDLE = create_paralist();query_list("OBJ_WLANSETTING_ID", "IGD");query_list("OBJ_WDS_ID", query_identity(0));WDS_IDENTITY = query_identity(0);create_hidden_newpara(WDS_PARA, WDS_PARANUM);get_inst(WDS_HANDLE, WDS_OBJNAME, WDS_IDENTITY);cover_hidden(WDS_HANDLE, WDS_PARA, WDS_PARANUM);destroy_paralist(WDS_HANDLE);}var FP_ACTION = request("IF_ACTION");if (FP_ACTION == "modeChange"){modeSet();}else if (FP_ACTION == "repeaterAdd"|| FP_ACTION == "rootSet"){WDSInstSet();}create_form_start("fSubmit", "");createBasicHidden();modeGet();var wdsMode = getenv("wdsMode");if (wdsMode == "WDS_Root"|| wdsMode == "WDS_Repeater"){WDSInstGet();}getDisplayInstError("SUCC");create_form_end();%>