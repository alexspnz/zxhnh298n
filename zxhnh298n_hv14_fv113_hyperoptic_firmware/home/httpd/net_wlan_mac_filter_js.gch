<script language="javascript">var MAC_PARA = new Array("ViewName","Interface","MACAddress");var BASIC_PARA = new Array("ACLPolicy");var index ="";var ssidnum1 = 0;var ssidnum2 = 0;var ssidnum3 = 0;var ssidnum4 = 0;function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(105, "&?error_105;");str[2] = new Array(118, "&?error_118;");str[3] = new Array(119, "&?error_119;");str[4] = new Array(122, "&?error_122;");str[5] = new Array(127, "&?error_127;");str[6] = new Array(143, "&?error_143;");str[7] = new Array(102, "&?error_102;");str[8] = new Array(103, "&?error_103;");str[9] = new Array(110, "&?error_110;");return getMsgFormArray(str, arguments)}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);pageGetValue();moveErrLayer(570,4);}function Wireless_switch(){var RealRF = getValue("RealRF");if( RealRF== "1"){getObj("tipLi").innerHTML = "&?cwm1;&?pub000;";jslEnDisplay("t_warn");jslEnable("Frm_SSID_SET","Frm_Mode","mac1","mac2","mac3","mac4","mac5","mac6","add");var num = getValue("IF_INSTNUM");for(var i = 0; i < num; i++){jslEnable("Btn_Delete"+ i);}}else {getObj("tipLi").innerHTML = "&?wlan064;&?pub002;";jslEnDisplay("t_warn");jslDisable("Frm_SSID_SET","Frm_Mode","mac1","mac2","mac3","mac4","mac5","mac6","add");var num = getValue("IF_INSTNUM");for(var i = 0; i < num; i++){jslDisable("Btn_Delete"+ i);}}}function pageGetValue(){jslSetValue( "Frm_Mode","ACLPolicy");jslSetValue( "Frm_SSID_SET","IF_VIEWID");showTable();Wireless_switch();}function showTable(){var newline = getObj("MAC_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");newline.setAttribute("id", "nodata");var objcell = newline.insertCell(-1);objcell.colSpan = 3;objcell.innerHTML= "&?note_007;";var num = getValue("IF_INSTNUM");for(var i = 0; i < num; i++){addline(i);}if((ssidnum1 != 0 && getValue("Frm_SSID_SET") == "IGD.LD1.WLAN1")||(ssidnum2 != 0 && getValue("Frm_SSID_SET") == "IGD.LD1.WLAN2")||(ssidnum3 != 0 && getValue("Frm_SSID_SET") == "IGD.LD1.WLAN3")||(ssidnum4 != 0 && getValue("Frm_SSID_SET") == "IGD.LD1.WLAN4")){jslDiDisplay("nodata");}}function addline(index){var newline = getObj("MAC_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");newline.setAttribute("id", "line"+index);jslEnDisplay("line"+ index);var viewid = getValue("Frm_SSID_SET");var iface;switch(viewid){case "IGD.LD1.WLAN1":iface = 0;break;case "IGD.LD1.WLAN2":iface = 1;break;case "IGD.LD1.WLAN3":iface = 2;break;case "IGD.LD1.WLAN4":iface = 3;break;}if(iface != getValue("Interface"+index)){jslDiDisplay("line"+ index);}if(getValue("Interface"+index)=="0"){setValue("Interface"+index,"SSID1");ssidnum1++;}if(getValue("Interface"+index)=="1"){setValue("Interface"+index,"SSID2");ssidnum2++;}if(getValue("Interface"+index)=="2"){setValue("Interface"+index,"SSID3");ssidnum3++;}if(getValue("Interface"+index)=="3"){setValue("Interface"+index,"SSID4");ssidnum4++;}cellId = "Line_"+ index + "_"+ MAC_PARA[1] + "_"+ 0;newline.insertCell(-1).innerHTML = getNameValue(cellId, 10, getValue("Interface"+index));cellId = "Line_"+ index + "_"+ MAC_PARA[2] + "_"+ 1;newline.insertCell(-1).innerHTML = getNameValue(cellId, 25, getValue("MACAddress"+index));if(getValue("Interface"+index)=="SSID1")setValue("Interface"+index,"0");if(getValue("Interface"+index)=="SSID2")setValue("Interface"+index,"1");if(getValue("Interface"+index)=="SSID3")setValue("Interface"+index,"2");if(getValue("Interface"+index)=="SSID4")setValue("Interface"+index,"3");newline.insertCell(-1).innerHTML=getImage("img/button_delete.gif", "Delete("+index+")", "Btn_Delete"+index);}function getImage(src, strmethod,Btn_id){return ("<input type=\"button\" id=\""+Btn_id+"\"  onclick=\""+ strmethod +"\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("+src+");\">");}function getNameValue(id, size, value){return ("<input type=\"text\" class=\"uiNoBorder\" size=\"" + size +"\" value=\""
+ HTMLEnCode(value) + "\"  id=\"" + id + "\"  readonly>");}function Add(){var number = getValue("IF_INSTNUM");document.getElementById("add").style.display="";if(pageCheckValue() == true){for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i);}jslDisable("add");pageSetValue();setValue("IF_ACTION", "new");setValue("IF_INDEX", "-1");DisableALL();getObj("fSubmit").submit();}else {}}function pageCheckValue(){var msg = "";var value = MacSetValue();if(value == ""){msg = getmsg(101);ShowErrorForCom("mac1","Frm_MAC",msg);return false;}if((CheckMac(value) != true)&&(value !="")){msg = getmsg(110);ShowErrorForCom("mac1","Frm_MAC",msg);return false;}if ( value.toLowerCase() == "ff:ff:ff:ff:ff:ff"){msg = getmsg(110);ShowErrorForCom("mac1","Frm_MAC",msg);return false;}if ( value.toLowerCase() == "00:00:00:00:00:00"){msg = getmsg(110);ShowErrorForCom("mac1","Frm_MAC",msg);return false;}return true;}function pageSetValue(){HiddenParaInit(MAC_PARA);var value = MacSetValue();setValue("MACAddress",value);var viewid = getValue("Frm_SSID_SET");var iface;switch(viewid){case "IGD.LD1.WLAN1":iface = 0;break;case "IGD.LD1.WLAN2":iface = 1;break;case "IGD.LD1.WLAN3":iface = 2;break;case "IGD.LD1.WLAN4":iface = 3;break;}setValue("Interface", iface);setValue("IF_VIEWID", getValue("Frm_SSID_SET"));}function toNext(obj){}function MacSetValue(){var value = getValue("mac1");value += ":"+ getValue("mac2");value += ":"+ getValue("mac3");value += ":"+ getValue("mac4");value += ":"+ getValue("mac5");value += ":"+ getValue("mac6");if( ":::::"== value){value = "";}return value;}function Delete(i){var number = getValue("IF_INSTNUM");setValue("IF_ACTION", "delete");setValue("IF_INDEX",i);jslDisable("add");for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i);}DisableALL();getObj("fSubmit").submit();}function Slect_Mode(){HiddenParaInit(BASIC_PARA);jslSetValue("IF_VIEWID","Frm_SSID_SET");jslSetValue("ACLPolicy", "Frm_Mode");setValue("IF_ACTION", "apply");DisableALL();getObj("fSubmit").submit();}function CheckMac(Addr){var c = '';var i = 0, j = 0;var addrParts = Addr.split(':');if ( addrParts.length != 6 )return false;for (i = 0; i < 6; i++){if (addrParts[i].length != 2)return false;for ( j = 0; j < addrParts[i].length; j++ ){c = addrParts[i].toLowerCase().charAt(j);if ( (c >= '0' && c <= '9') ||(c >= 'a' && c <= 'f') )continue;else return false;}}return true;}function ESSID_Choose(){var url = getURL("net_wlan_MacFilter_t.gch", "IF_VIEWID", getValue("Frm_SSID_SET"));DisableALL();location.href = url;}</script>