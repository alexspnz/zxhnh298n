<script language="javascript">var DIAL_PLAN_PARA = ["ViewName","Range","MinNum","MaxNum", "NumRem", "PosRem", "DefPort", "BakPort", "FacilityAction", "FacilityActionArgument"];var index ="";function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);moveErrLayer(580,75);showTable();}function getImage(src, strmethod,Btn_id){return ("<input type=\"image\" id=\""+Btn_id+"\"  onclick=\""+ strmethod +"\" src=\""+src+"\" style=\"cursor:pointer\">");}function getInput(value,len){return ("<input class=\"uiNoBorder\"  type=\"text\"  size=\""
+len
+"\" value=\""
+HTMLEnCode(value)
+"\" readonly>");}function addline(index){var newline = getObj("Static_rt_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");for(var i = 1; i < DIAL_PLAN_PARA.length ; i++){if( 6 == i || 7 == i){if(0 == getValue(DIAL_PLAN_PARA[i]+index)){newline.insertCell(-1).innerHTML = "";}else if(1 == getValue(DIAL_PLAN_PARA[i]+index)){newline.insertCell(-1).innerHTML = "VoIP";}else if(2 == getValue(DIAL_PLAN_PARA[i]+index)){newline.insertCell(-1).innerHTML = "PSTN";}}else if(1 == i){newline.insertCell(-1).innerHTML = getInput(getValue(DIAL_PLAN_PARA[i]+index),4);}else if(9 == i){newline.insertCell(-1).innerHTML = getInput(getValue(DIAL_PLAN_PARA[i]+index),8);}else {newline.insertCell(-1).innerHTML = getValue(DIAL_PLAN_PARA[i]+index);}}newline.insertCell(-1).innerHTML=getImage("img/button_modify.gif", "Modify("+index+")","Btn_Modify"+index);newline.insertCell(-1).innerHTML=getImage("img/button_delete.gif", "Delete("+index+")","Btn_Delete"+index);}function showTable(){var num = getValue("IF_INSTNUM");if(num == 0){var newline = getObj("Static_rt_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);for(var i = 0; i < 10; i++){var objcelltmp = newline.insertCell(-1);objcelltmp.parentNode.removeChild(objcelltmp);}objcell.colSpan = i + 1;objcell.innerHTML= "&?note_007;";}for(var i = 0; i < num; i++){addline(i);}}function checkNum(frm_id, fnt_id, isNull, minValue, maxValue){var msg = "";if( 0 == isNull && false == checkNull(getValue(frm_id)) ){return true;}var numCheck = checkIntegerRange(getValue(frm_id), minValue, maxValue);if("-1"== numCheck){msg = getmsg(101);ShowErrorForCom(frm_id, fnt_id, msg);return false;}if("-2"== numCheck){msg = getmsg(115);ShowErrorForCom(frm_id, fnt_id, msg);return false;}else if("-3"== numCheck){msg = getmsg(116, minValue, maxValue);ShowErrorForCom(frm_id, fnt_id, msg);return false;}return true;}function checkName(frm_id, fnt_id, isNull, minLength, maxLength){var msg = "";if( 0 == isNull && false == checkNull(getValue(frm_id)) ){return true;}var nameCheck = checkStrLengthRange(getValue(frm_id), minLength, maxLength);if("-1"== nameCheck){msg = getmsg(101);ShowErrorForCom(frm_id, fnt_id, msg);return false;}else if(false == checkGenStringForASC(getValue(frm_id))){msg = getmsg(114);ShowErrorForCom(frm_id, fnt_id, msg);return false;}else if("-3"== nameCheck){msg = getmsg(102, minLength, maxLength);ShowErrorForCom(frm_id, fnt_id, msg);return false;}return true;}function pageSetValue(){jslSetValue("Range", "Frm_Range");jslSetValue("MinNum", "Frm_MinNum");jslSetValue("MaxNum", "Frm_MaxNum");jslSetValue("NumRem", "Frm_NumRem");jslSetValue("PosRem", "Frm_PosRem");jslSetValue("DefPort", "Frm_DefPort");jslSetValue("BakPort", "Frm_BakPort");var DefPort = getValue("Frm_DefPort");if(DefPort == "1"){jslSetValue("FacilityAction", "Frm_FacilityAction");jslSetValue("FacilityActionArgument", "Frm_FacilityActionArgument");}else {setValue("FacilityAction","0");setValue("FacilityActionArgument","");}}function pageCheckValue(){var msg = "";if(false == checkName("Frm_Range", "Fnt_Range", 1, 1, 42)){return false;}if(false == checkNum("Frm_MinNum", "Fnt_MinNum", 1, 1, 40)){return false;}if(false == checkNum("Frm_MaxNum", "Fnt_MaxNum", 1, 1, 40)){return false;}if(parseInt(getValue("Frm_MinNum")) > parseInt(getValue("Frm_MaxNum"))){msg = getmsg(150);ShowErrorForCom("Frm_MaxNum", "Fnt_MaxNum", msg);return false;}if(false == checkNum("Frm_NumRem", "Fnt_NumRem", 1, 0, 40)){return false;}if(false == checkNum("Frm_PosRem", "Fnt_PosRem", 1, 0, 40)){return false;}if(false == checkNum("Frm_DefPort", "Fnt_DefPort", 1, 1, 2)){return false;}if(false == checkNum("Frm_BakPort", "Fnt_BakPort", 1, 0, 2)){return false;}var DefPort = getValue("Frm_DefPort");if(DefPort == "1"){var FacilityAction = getValue("Frm_FacilityAction");if(FacilityAction == "1"|| FacilityAction =="2"){if(false == checkName("Frm_FacilityActionArgument", "Fnt_FacilityActionArgument", 0, 0, 256)){return false;}}}return true;}function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(102, "&?error_102;");str[2] = new Array(103, "&?error_103;");str[3] = new Array(105, "&?error_105;");str[4] = new Array(115, "&?error_115;");str[5] = new Array(116, "&?error_116;");str[6] = new Array(117, "&?error_117;");str[7] = new Array(118, "&?error_118;");str[8] = new Array(119, "&?error_119;");str[9] = new Array(122, "&?error_122;");str[10] = new Array(143, "&?error_143;");str[11] = new Array(144, "&?error_144;");str[12] = new Array(114, "&?error_114;");str[13] = new Array(108, "&?error_108;");str[14] = new Array(109, "&?error_109;");str[15] = new Array(130, "&?error_130;");str[16] = new Array(127, "&?error_127;");str[17] = new Array(150, "&?dailplan_150;");return getMsgFormArray(str, arguments)}function pageReFresh(){getObj("fSubmit").submit();}function Add(){var num = getValue("IF_INSTNUM");document.getElementById("Btn_Add").style.display="";document.getElementById("Btn_Modify").style.display="none";if(true == pageCheckValue()){for(var i = 0; i < num; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}jslDisable("Btn_Add","Btn_Modify");pageSetValue();setValue("IF_ACTION", "new");setValue("IF_INDEX", "-1");getObj("fSubmit").submit();}else {}}function triggerOnChange(eleId){var ele = getObj(eleId);if (ele.onchange){ele.onchange();}}function ModifyGetValue(i){jslSetValue("Frm_Range", "Range"+i );jslSetValue("Frm_MinNum", "MinNum"+i );jslSetValue("Frm_MaxNum", "MaxNum"+i );jslSetValue("Frm_NumRem", "NumRem"+i );jslSetValue("Frm_PosRem", "PosRem"+i );jslSetValue("Frm_DefPort", "DefPort"+i);jslSetValue("Frm_BakPort", "BakPort"+i);jslSetValue("Frm_FacilityAction", "FacilityAction"+i);jslSetValue("Frm_FacilityActionArgument", "FacilityActionArgument"+i);setValueDP(getValue("DefPort"+i));setValueFA(getValue("FacilityAction"+i));}function setValueDP(newValue){newValue = parseInt(newValue);switch (newValue){case 2:jslDiDisplay("TR_FacilityAction", "TR_FacilityActionArgument");break;case 1:default:jslEnDisplay("TR_FacilityAction", "TR_FacilityActionArgument");triggerOnChange("Frm_FacilityAction");break;}return false;}function setValueFA(newValue){newValue = parseInt(newValue);switch (newValue){case 0:setValue("Frm_FacilityActionArgument", "");jslDiDisplay("TR_FacilityActionArgument");break;case 1:case 2:default:jslEnDisplay("TR_FacilityActionArgument");break;}return false;}function Modify(i){document.getElementById("Btn_Add").style.display="none";document.getElementById("Btn_Modify").style.display="";ModifyGetValue(i);index=i;}function Delete(i){var num = getValue("IF_INSTNUM");setValue("IF_ACTION", "delete");setValue("IF_INDEX",i);jslDisable("Btn_Add","Btn_Modify");for(i = 0; i < num; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}getObj("fSubmit").submit();}function ModifySubmit(){var num = getValue("IF_INSTNUM");if(pageCheckValue() == true){for(i = 0; i < num; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}jslDisable("Btn_Add","Btn_Modify");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_INDEX",index);getObj("fSubmit").submit();}else {}}</script>