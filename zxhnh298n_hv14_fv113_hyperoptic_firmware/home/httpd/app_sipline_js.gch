<script language="javascript">var SIP_PARA = new Array("Enable","AuthUserName","AuthPassword","DigestUserName","DisplayName","RegStatus","DNSStatus");var SIPLINE_PARA = new Array("Enable","AuthUserName","DigestUserName");var VPLINE_PARA = new Array();var index = "";var sepStr = "						";function getmsg(id){var str = new Array();str[0] = new Array(102, "&?error_102;");str[1] = new Array(103, "&?error_103;");str[2] = new Array(118, "&?error_118;");str[3] = new Array(119, "&?error_119;");str[4] = new Array(122, "&?error_122;");str[5] = new Array(114, "&?error_114;");str[6] = new Array(167, "&?error_167;");return getMsgFormArray(str, arguments);}function pageLoad(url){moveErrLayer(580,95);getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");ProcessRet(errstr, errpara);showTable();pageGetValue();}function getImage(src, strmethod, id){return ("<input type=\"button\" id=\""+id+"\"  onclick=\""+ strmethod +"\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("+src+");\">");}function getInput(id,len){return ("<input class=\"uiNoBorder\"  type=\"text\"  size=\""+len+"\" id=\""+id+"\" readonly>");}function addline(index){var newline = getObj("Sipline_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");for(var i = 0; i < SIPLINE_PARA.length ; i++){if(SIPLINE_PARA[i] == "DigestUserName"){newline.insertCell(-1).innerHTML = getInput("Frm_"+SIPLINE_PARA[i]+index,24);}else if(SIPLINE_PARA[i] == "Enable"){newline.insertCell(-1).innerHTML = showIsEnableImage(getValue(SIPLINE_PARA[i]+index), "Frm_"+SIPLINE_PARA[i]+index);}else {newline.insertCell(-1).innerHTML = getInput("Frm_"+SIPLINE_PARA[i]+index,8);}}for(var i = 0; i < VPLINE_PARA.length ; i++){newline.insertCell(-1).innerHTML = getInput("Frm_"+VPLINE_PARA[i]+index,16);}newline.insertCell(-1).innerHTML=getImage("img/button_modify.gif", "Modify("+index+")", "BtnMod"+index);}function showTable(){var num = getValue("IF_INSTNUM");for(var i = 0; i < num; i++){addline(i);}}function transPhyListValue(tid_list){var tid_arr = tid_list.split(",");var result_arr = [];var tid_count = GetHomeLineInstNum();for (var i = 0; i < tid_count; i++){var checkbox = getObj("Frm_HomeLine"+ i);var _tid = checkbox.getAttribute("_tid");if (in_array(_tid, tid_arr)){result_arr.push(i);}}return result_arr.join(",");}function pageGetValue(){var index = getValue("IF_INSTNUM");for(var i = 0; i < index; i++){for(var j = 1; j < SIPLINE_PARA.length ; j++){setValue("Frm_"+SIPLINE_PARA[j]+i,getValue(SIPLINE_PARA[j]+i));}for(var j = 0; j < VPLINE_PARA.length ; j++){if (VPLINE_PARA[j] == "PhyList"){setValue("Frm_"+VPLINE_PARA[j]+i,transPhyListValue(getValue(VPLINE_PARA[j]+i)));}else {setValue("Frm_"+VPLINE_PARA[j]+i,getValue(VPLINE_PARA[j]+i));}}}}function pageSetValue(){HiddenParaInit(SIP_PARA);jslViewToPostCheckBox("Enable", "Frm_Enable");jslSetValue("AuthUserName", "Frm_AuthUserName");if(getValue("Frm_AuthPassword") != sepStr){jslSetValue("AuthPassword", "Frm_AuthPassword","SET");}jslSetValue("DigestUserName", "Frm_DigestUserName");jslSetValuePhyListSet("PhyList");}function pageCheckValue(){var msg = "";if(checkGenStringForASC(getValue("Frm_AuthUserName")) == false){msg = getmsg(114);ShowErrorForCom("Frm_AuthUserName","Fnt_AuthUserName",msg);return false;}if(checkStrLengthRange(getValue("Frm_AuthUserName"),0,127) == -3){msg = getmsg(102,0,127);ShowErrorForCom("Frm_AuthUserName","Fnt_AuthUserName",msg);return false;}if(getValue("Frm_AuthPassword") != sepStr){if(checkPasswordGenStringForASC(getValue("Frm_AuthPassword")) == false){msg = getmsg(114);ShowErrorForCom("Frm_AuthPassword","Fnt_AuthPassword",msg);return false;}if(checkStrLengthRange(getValue("Frm_AuthPassword"),0,31) == -3){msg = getmsg(102,0,31);ShowErrorForCom("Frm_AuthPassword","Fnt_AuthPassword",msg);return false;}}if(checkGenStringForASC(getValue("Frm_DigestUserName")) == false){msg = getmsg(114);ShowErrorForCom("Frm_DigestUserName","Fnt_DigestUserName",msg);return false;}if(checkStrLengthRange(getValue("Frm_DigestUserName"),0,127) == -3){msg = getmsg(102,0,127);ShowErrorForCom("Frm_DigestUserName","Fnt_DigestUserName",msg);return false;}return true;}function pageCancel(){DisableALL();getObj("fSubmit").submit();}function pageSubmit(){if(pageCheckValue() == true){pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_INDEX",index);DisableALL();getObj("fSubmit").submit();}else {}}function GetHomeLineInstNum(){return getValue("HomeLine_INSTNUM");}function jslEnableDisablePhyList(flag){var n = GetHomeLineInstNum();for (var i = 0; i < n; i++){if (flag){jslEnable("Frm_HomeLine"+ i);}else {jslDisable("Frm_HomeLine"+ i);}}}function jslSetValuePhyListGet(eleId){var phyListArr = getValue(eleId).split(",");var n = GetHomeLineInstNum();for (var i = 0; i < n; i++){var checkbox = getObj("Frm_HomeLine"+ i);var tid = ""+ checkbox.getAttribute("_tid");var match = false;if (in_array(tid, phyListArr)){match = true;}setChecked("Frm_HomeLine"+ i, match);}}function jslSetValuePhyListSet(eleId){var phyListArr = [];var n = GetHomeLineInstNum();for (var i = 0; i < n; i++){var checkbox = getObj("Frm_HomeLine"+ i);var tid = ""+ checkbox.getAttribute("_tid");if (getChecked("Frm_HomeLine"+ i) && tid){phyListArr.push(tid);}}setValue(eleId, phyListArr.join(","));}function ModifyGetValue(i){jslPostToViewCheckBox("Frm_Enable","Enable"+i);jslSetValue("Frm_AuthUserName", "AuthUserName"+i);jslSetValue("Frm_DigestUserName", "DigestUserName"+i);jslSetValuePhyListGet("PhyList"+ i);}function Modify(i){getObj("modify").style.display="";document.getElementById("back").style.display="";jslEnable("Frm_AuthUserName","Frm_AuthPassword","Frm_DigestUserName","Frm_Enable");jslEnableDisablePhyList(true);ModifyGetValue(i);index=i;}function ModifySubmit(){if(pageCheckValue() == true){jslDisable("modify", "back");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_INDEX",index);DisableALL();getObj("fSubmit").submit();}else {}}function back4add(){var number = getValue("IF_INSTNUM");jslDisable("modify", "back");for(var i = 0; i < number; i++){jslDisable("BtnMod"+ i);}DisableALL();getObj("fSubmit").submit();}function selectInputContent(){var pass =getObj("Frm_AuthPassword");pass.select();pass.focus();}function checkPasswordGenStringForASC(value){var length = value.length;for(var j = 0 ;j < length; j++){var xx = value.charCodeAt(j);if (xx >= 32 && xx <= 126){}else {return false;}}return true;}</script>